{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\amaar\\\\braindump\\\\frontend\\\\src\\\\pages\\\\CanvasPage.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$(),\n  _s5 = $RefreshSig$(),\n  _s6 = $RefreshSig$(),\n  _s7 = $RefreshSig$(),\n  _s8 = $RefreshSig$();\nimport React, { useRef, useState, useEffect, useCallback } from \"react\";\nimport { LuUndo2, LuRedo2, LuSettings2, LuDownload, LuStickyNote, LuImage, LuSquare, LuCircle, LuTriangle, LuArrowUpRight, LuEraser, LuHand, LuMousePointer2, LuPencil, LuType, LuShapes, LuPalette, LuGripHorizontal, LuChevronDown, LuSun, LuMoon, LuBrain, LuShare2, LuFileText, LuImage as LuImageIcon } from \"react-icons/lu\";\nimport io from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TOOL_SELECT = \"select\";\nconst TOOL_DRAW = \"draw\";\nconst TOOL_ERASE = \"erase\";\nconst TOOL_RECT = \"rect\";\nconst TOOL_ELLIPSE = \"ellipse\";\nconst TOOL_LINE = \"line\";\nconst TOOL_TEXT = \"text\";\nconst FONT_OPTIONS = [{\n  label: 'Inter',\n  value: 'Inter, sans-serif'\n}, {\n  label: 'Comic Sans',\n  value: 'Comic Sans MS, Comic Sans, cursive'\n}, {\n  label: 'Serif',\n  value: 'serif'\n}, {\n  label: 'Mono',\n  value: 'monospace'\n}, {\n  label: 'Montserrat',\n  value: 'Montserrat, sans-serif'\n}];\nconst COLORS_LIGHT = [\"#000000\", \"#ffffff\", \"#e03131\", \"#1971c2\", \"#fab005\", \"#40c057\", \"#ae3ec9\", \"#fd7e14\"];\nconst COLORS_DARK = [\"#ffffff\", \"#000000\", \"#fa5252\", \"#4dabf7\", \"#ffe066\", \"#69db7c\", \"#b197fc\", \"#ffa94d\"];\nfunction useIsDarkMode() {\n  _s();\n  const [isDark, setIsDark] = useState(() => document.documentElement.classList.contains(\"dark\"));\n  useEffect(() => {\n    const observer = new MutationObserver(() => {\n      setIsDark(document.documentElement.classList.contains(\"dark\"));\n    });\n    observer.observe(document.documentElement, {\n      attributes: true,\n      attributeFilter: [\"class\"]\n    });\n    return () => observer.disconnect();\n  }, []);\n  return isDark;\n}\n_s(useIsDarkMode, \"FOQbUfq8njgxVXfRglQFJvArXaM=\");\nconst tools = [{\n  key: TOOL_SELECT,\n  label: \"Select\",\n  icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n    width: \"20\",\n    height: \"20\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    strokeWidth: \"2\",\n    children: /*#__PURE__*/_jsxDEV(\"path\", {\n      d: \"M3 3l14 7-7 3-3 7-4-17z\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 83\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 42,\n    columnNumber: 5\n  }, this)\n}, {\n  key: TOOL_DRAW,\n  label: \"Draw\",\n  icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n    width: \"20\",\n    height: \"20\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    strokeWidth: \"2\",\n    children: /*#__PURE__*/_jsxDEV(\"path\", {\n      d: \"M4 15.5V19h3.5l10-10.1-3.5-3.4L4 15.5z\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 83\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 45,\n    columnNumber: 5\n  }, this)\n}, {\n  key: TOOL_ERASE,\n  label: \"Eraser\",\n  icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n    width: \"20\",\n    height: \"20\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    strokeWidth: \"2\",\n    children: [/*#__PURE__*/_jsxDEV(\"rect\", {\n      x: \"3\",\n      y: \"14\",\n      width: \"13\",\n      height: \"3\",\n      rx: \"1.5\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 83\n    }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n      d: \"M5 13l7-7a2 2 0 112.8 2.8l-7 7\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 134\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 5\n  }, this)\n}, {\n  key: TOOL_RECT,\n  label: \"Rectangle\",\n  icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n    width: \"20\",\n    height: \"20\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    strokeWidth: \"2\",\n    children: /*#__PURE__*/_jsxDEV(\"rect\", {\n      x: \"4\",\n      y: \"4\",\n      width: \"12\",\n      height: \"12\",\n      rx: \"2\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 83\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 5\n  }, this)\n}, {\n  key: TOOL_ELLIPSE,\n  label: \"Ellipse\",\n  icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n    width: \"20\",\n    height: \"20\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    strokeWidth: \"2\",\n    children: /*#__PURE__*/_jsxDEV(\"ellipse\", {\n      cx: \"10\",\n      cy: \"10\",\n      rx: \"7\",\n      ry: \"5\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 83\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 5\n  }, this)\n}, {\n  key: TOOL_LINE,\n  label: \"Line\",\n  icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n    width: \"20\",\n    height: \"20\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    strokeWidth: \"2\",\n    children: /*#__PURE__*/_jsxDEV(\"line\", {\n      x1: \"4\",\n      y1: \"16\",\n      x2: \"16\",\n      y2: \"4\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 83\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this)\n}, {\n  key: TOOL_TEXT,\n  label: \"Text\",\n  icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n    width: \"20\",\n    height: \"20\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    strokeWidth: \"2\",\n    children: /*#__PURE__*/_jsxDEV(\"text\", {\n      x: \"4\",\n      y: \"16\",\n      fontSize: \"12\",\n      fontFamily: \"sans-serif\",\n      children: \"T\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 83\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this)\n}];\nconst undoIcon = /*#__PURE__*/_jsxDEV(LuUndo2, {\n  size: 22\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 64,\n  columnNumber: 18\n}, this);\nconst redoIcon = /*#__PURE__*/_jsxDEV(LuRedo2, {\n  size: 22\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 65,\n  columnNumber: 18\n}, this);\n\n// Custom DarkModeToggle for top right\nfunction DarkModeToggleTop() {\n  _s2();\n  const [dark, setDark] = useState(() => document.documentElement.classList.contains(\"dark\"));\n  useEffect(() => {\n    if (dark) {\n      document.documentElement.classList.add(\"dark\");\n    } else {\n      document.documentElement.classList.remove(\"dark\");\n    }\n  }, [dark]);\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    onClick: () => setDark(d => !d),\n    className: \"p-2 ml-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800\",\n    title: dark ? \"Switch to light mode\" : \"Switch to dark mode\",\n    children: dark ? /*#__PURE__*/_jsxDEV(LuSun, {\n      size: 22,\n      color: \"#fff\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 15\n    }, this) : /*#__PURE__*/_jsxDEV(LuMoon, {\n      size: 22,\n      color: \"#222\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 50\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n}\n\n// Download Modal Component\n_s2(DarkModeToggleTop, \"Kws2k1gFF6VdH9CCgtoEikh3yvU=\");\n_c = DarkModeToggleTop;\nfunction DownloadModal({\n  open,\n  onClose,\n  onDownload,\n  isDark\n}) {\n  if (!open) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 z-50 flex items-center justify-center bg-black/30 dark:bg-black/60\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `bg-white dark:bg-zinc-900 rounded-xl shadow-xl p-6 w-[370px] max-w-full relative border border-gray-200 dark:border-zinc-700`,\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onClose,\n        className: \"absolute top-3 right-3 text-2xl text-gray-400 hover:text-gray-700 dark:hover:text-gray-200\",\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-semibold mb-4 text-gray-900 dark:text-gray-100\",\n        children: \"Download Options\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => onDownload('pdf'),\n          className: \"w-full flex items-center gap-3 px-4 py-3 rounded-lg border border-gray-200 dark:border-zinc-700 hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors\",\n          children: [/*#__PURE__*/_jsxDEV(LuFileText, {\n            size: 24,\n            className: \"text-blue-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-left\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"font-medium text-gray-900 dark:text-gray-100\",\n              children: \"Download as PDF\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-500 dark:text-gray-400\",\n              children: \"High quality vector format\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 105,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => onDownload('jpg'),\n          className: \"w-full flex items-center gap-3 px-4 py-3 rounded-lg border border-gray-200 dark:border-zinc-700 hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors\",\n          children: [/*#__PURE__*/_jsxDEV(LuImageIcon, {\n            size: 24,\n            className: \"text-green-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-left\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"font-medium text-gray-900 dark:text-gray-100\",\n              children: \"Download as JPG\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-500 dark:text-gray-400\",\n              children: \"Image format\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 5\n  }, this);\n}\n_c2 = DownloadModal;\nfunction TopControlsBox({\n  onUndo,\n  onRedo,\n  boardId,\n  onDownload\n}) {\n  _s3();\n  // Detect dark mode for icon color\n  const [isDark, setIsDark] = useState(() => document.documentElement.classList.contains(\"dark\"));\n  const [copied, setCopied] = useState(false);\n  const [dropdownOpen, setDropdownOpen] = useState(false);\n  const [showDownloadModal, setShowDownloadModal] = useState(false);\n  useEffect(() => {\n    const observer = new MutationObserver(() => {\n      setIsDark(document.documentElement.classList.contains(\"dark\"));\n    });\n    observer.observe(document.documentElement, {\n      attributes: true,\n      attributeFilter: [\"class\"]\n    });\n    return () => observer.disconnect();\n  }, []);\n  const iconColor = isDark ? \"#fff\" : \"#222\";\n  // Toggle dark mode\n  const handleDropdownToggleDark = () => {\n    if (isDark) {\n      document.documentElement.classList.remove(\"dark\");\n    } else {\n      document.documentElement.classList.add(\"dark\");\n    }\n    setIsDark(!isDark);\n    setDropdownOpen(false);\n  };\n  // Share logic\n  const url = `${window.location.origin}${window.location.pathname}#${boardId}`;\n  const handleCopy = () => {\n    navigator.clipboard.writeText(url);\n    setCopied(true);\n    setTimeout(() => setCopied(false), 1500);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed top-4 right-6 z-50 flex items-center gap-2 bg-white/90 dark:bg-zinc-900/90 border border-gray-200 dark:border-zinc-700 rounded-xl shadow-lg px-3 py-2\",\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      title: \"Undo (Ctrl+Z)\",\n      className: \"p-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800\",\n      onClick: onUndo,\n      children: /*#__PURE__*/_jsxDEV(LuUndo2, {\n        size: 22,\n        color: iconColor\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 119\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      title: \"Redo (Ctrl+Y)\",\n      className: \"p-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800\",\n      onClick: onRedo,\n      children: /*#__PURE__*/_jsxDEV(LuRedo2, {\n        size: 22,\n        color: iconColor\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 119\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      title: \"Export\",\n      className: \"p-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800\",\n      onClick: () => setShowDownloadModal(true),\n      children: /*#__PURE__*/_jsxDEV(LuDownload, {\n        size: 22,\n        color: iconColor\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 138\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative z-[9999]\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        title: \"Preferences\",\n        className: \"p-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800\",\n        onClick: () => setDropdownOpen(v => !v),\n        children: /*#__PURE__*/_jsxDEV(LuSettings2, {\n          size: 22,\n          color: iconColor\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 9\n      }, this), dropdownOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute right-0 mt-2 w-52 border border-zinc-200 dark:border-zinc-800 rounded-lg shadow-lg py-2 z-[9999] text-sm bg-white/90 dark:bg-zinc-900/90 backdrop-blur-sm pointer-events-auto\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between px-4 py-2 gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(LuMoon, {\n              size: 18,\n              className: \"text-zinc-500 dark:text-zinc-200\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: isDark ? 'Light Mode' : 'Dark Mode'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            \"aria-label\": \"Toggle dark mode\",\n            onClick: handleDropdownToggleDark,\n            className: `relative w-10 h-6 rounded-full transition-colors duration-200 ${isDark ? 'bg-teal-500' : 'bg-zinc-300'}`,\n            style: {\n              minWidth: 40\n            },\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: `absolute top-1 left-1 w-4 h-4 rounded-full bg-white shadow transition-transform duration-200 ${isDark ? 'translate-x-4' : ''}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        title: \"Copy board link\",\n        className: \"p-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800\",\n        onClick: handleCopy,\n        children: /*#__PURE__*/_jsxDEV(LuShare2, {\n          size: 22,\n          color: iconColor\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 9\n      }, this), copied && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute right-0 mt-2 px-2 py-1 bg-zinc-900 text-white text-xs rounded shadow\",\n        children: \"Link copied!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DownloadModal, {\n      open: showDownloadModal,\n      onClose: () => setShowDownloadModal(false),\n      onDownload: onDownload,\n      isDark: isDark\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 156,\n    columnNumber: 5\n  }, this);\n}\n_s3(TopControlsBox, \"UTJIg8FJk2/v5g5aP+L8uab6eSI=\");\n_c3 = TopControlsBox;\nfunction LogoStandalone() {\n  _s4();\n  // Use LuBrain icon for a literal brain representation\n  const [isDark, setIsDark] = useState(() => document.documentElement.classList.contains(\"dark\"));\n  useEffect(() => {\n    const observer = new MutationObserver(() => {\n      setIsDark(document.documentElement.classList.contains(\"dark\"));\n    });\n    observer.observe(document.documentElement, {\n      attributes: true,\n      attributeFilter: [\"class\"]\n    });\n    return () => observer.disconnect();\n  }, []);\n  const iconColor = isDark ? \"#fff\" : \"#222\";\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed top-4 left-6 z-50 flex items-center select-none\",\n    style: {\n      height: '3.5rem',\n      padding: '0.25rem 0.5rem'\n    },\n    children: [/*#__PURE__*/_jsxDEV(LuBrain, {\n      size: 48,\n      color: iconColor,\n      style: {\n        marginRight: 16,\n        flexShrink: 0\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      style: {\n        fontFamily: 'Montserrat, Inter, sans-serif',\n        fontWeight: 600,\n        fontSize: '2.1rem',\n        letterSpacing: '0.01em',\n        lineHeight: 1,\n        color: iconColor\n      },\n      children: \"braindump\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 225,\n    columnNumber: 5\n  }, this);\n}\n\n// Bottom Toolbar\n_s4(LogoStandalone, \"FOQbUfq8njgxVXfRglQFJvArXaM=\");\n_c4 = LogoStandalone;\nfunction BottomToolbar({\n  tool,\n  setTool\n}) {\n  const iconSize = 24;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed bottom-4 left-1/2 -translate-x-1/2 z-50 flex items-center bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-700 rounded-xl shadow-lg px-3 py-2 gap-1\",\n    style: {\n      minWidth: 320\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      title: \"Select\",\n      className: `p-2 rounded-lg ${tool === 'select' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`,\n      onClick: () => setTool('select'),\n      children: /*#__PURE__*/_jsxDEV(LuMousePointer2, {\n        size: iconSize\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 192\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      title: \"Hand\",\n      className: `p-2 rounded-lg ${tool === 'hand' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`,\n      onClick: () => setTool('hand'),\n      children: /*#__PURE__*/_jsxDEV(LuHand, {\n        size: iconSize\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 186\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      title: \"Draw\",\n      className: `p-2 rounded-lg ${tool === 'draw' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`,\n      onClick: () => setTool('draw'),\n      children: /*#__PURE__*/_jsxDEV(LuPencil, {\n        size: iconSize\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 186\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      title: \"Eraser\",\n      className: `p-2 rounded-lg ${tool === 'eraser' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`,\n      onClick: () => setTool('eraser'),\n      children: /*#__PURE__*/_jsxDEV(LuEraser, {\n        size: iconSize\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 192\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-px h-6 bg-gray-200 dark:bg-zinc-700 mx-1\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      title: \"Sticky Note\",\n      className: `p-2 rounded-lg ${tool === 'sticky' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`,\n      onClick: () => setTool('sticky'),\n      children: /*#__PURE__*/_jsxDEV(LuStickyNote, {\n        size: iconSize\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 197\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      title: \"Image\",\n      className: `p-2 rounded-lg ${tool === 'image' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`,\n      onClick: () => setTool('image'),\n      children: /*#__PURE__*/_jsxDEV(LuImage, {\n        size: iconSize\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 189\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      title: \"Text\",\n      className: `p-2 rounded-lg ${tool === 'text' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`,\n      onClick: () => setTool('text'),\n      children: /*#__PURE__*/_jsxDEV(LuType, {\n        size: iconSize\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 186\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      title: \"Shapes\",\n      className: `p-2 rounded-lg ${tool === 'shapes' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`,\n      onClick: () => setTool('shapes'),\n      children: /*#__PURE__*/_jsxDEV(LuShapes, {\n        size: iconSize\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 192\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 236,\n    columnNumber: 5\n  }, this);\n}\n\n// Right Toolbar\n_c5 = BottomToolbar;\nfunction RightToolbar({\n  tool,\n  eraserSize,\n  setEraserSize,\n  color,\n  setColor,\n  opacity,\n  setOpacity,\n  selectedStickyId,\n  selectedTextId,\n  stickyFont,\n  textFont,\n  onStickyColorChange,\n  onStickyFontChange,\n  onTextColorChange,\n  onTextFontChange,\n  elements\n}) {\n  const COLORS = [\"#fff\", \"#000\", \"#e03131\", \"#1971c2\", \"#fab005\", \"#40c057\", \"#ae3ec9\", \"#fd7e14\"];\n\n  // Determine if color palette should be enabled\n  const isColorEnabled = tool === 'draw' || selectedStickyId || selectedTextId;\n\n  // Get the current color based on selection\n  const getCurrentColor = () => {\n    if (tool === 'draw') return color;\n    if (selectedStickyId) {\n      const note = elements.stickyNotes.find(n => n.id === selectedStickyId);\n      return (note === null || note === void 0 ? void 0 : note.color) || \"#fff\";\n    }\n    if (selectedTextId) {\n      const text = elements.textBoxes.find(t => t.id === selectedTextId);\n      return (text === null || text === void 0 ? void 0 : text.color) || \"#222\";\n    }\n    return color;\n  };\n\n  // Handle color change based on current selection\n  const handleColorChange = newColor => {\n    if (tool === 'draw') {\n      setColor(newColor);\n    } else if (selectedStickyId) {\n      onStickyColorChange(newColor);\n    } else if (selectedTextId) {\n      onTextColorChange(newColor);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed top-20 right-6 z-40 flex flex-col items-center gap-5 bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-700 rounded-xl shadow-lg px-4 py-5 min-w-[180px]\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-gray-500 dark:text-gray-400 mb-1 font-medium\",\n        children: tool === 'draw' ? 'Pen Color' : selectedStickyId ? 'Sticky Color' : selectedTextId ? 'Text Color' : 'Color'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-wrap gap-2 mb-2\",\n        children: COLORS.map(c => /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all duration-100 ${isColorEnabled && getCurrentColor() === c ? 'border-zinc-900 dark:border-white scale-110 shadow' : 'border-gray-300 dark:border-zinc-700'} ${!isColorEnabled ? 'opacity-50 cursor-not-allowed' : ''}`,\n          style: {\n            background: c\n          },\n          onClick: () => isColorEnabled && handleColorChange(c),\n          \"aria-label\": `Select color ${c}`,\n          disabled: !isColorEnabled,\n          children: isColorEnabled && getCurrentColor() === c && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"w-2 h-2 rounded-full bg-white border border-zinc-900 dark:border-white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 61\n          }, this)\n        }, c, false, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between mb-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-gray-500 dark:text-gray-400 font-medium\",\n          children: \"Opacity\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-gray-500 dark:text-gray-400\",\n          children: [Math.round(opacity * 100), \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(LuGripHorizontal, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"range\",\n          min: \"0.1\",\n          max: \"1\",\n          step: \"0.01\",\n          value: opacity,\n          onChange: e => setOpacity(Number(e.target.value)),\n          className: \"w-full\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 7\n    }, this), selectedStickyId && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-gray-500 dark:text-gray-400 mb-1 font-medium\",\n        children: \"Sticky Font\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        className: \"w-full px-2 py-1 rounded border border-gray-300 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-sm disabled:opacity-50\",\n        value: stickyFont || '',\n        onChange: e => onStickyFontChange(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          disabled: true,\n          children: \"Select font\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 324,\n          columnNumber: 13\n        }, this), FONT_OPTIONS.map(f => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: f.value,\n          children: f.label\n        }, f.value, false, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 36\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 9\n    }, this), selectedTextId && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-gray-500 dark:text-gray-400 mb-1 font-medium\",\n        children: \"Text Font\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        className: \"w-full px-2 py-1 rounded border border-gray-300 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-sm disabled:opacity-50\",\n        value: textFont || '',\n        onChange: e => onTextFontChange(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          disabled: true,\n          children: \"Select font\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 338,\n          columnNumber: 13\n        }, this), FONT_OPTIONS.map(f => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: f.value,\n          children: f.label\n        }, f.value, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 36\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 9\n    }, this), tool === 'eraser' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between mb-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-gray-500 dark:text-gray-400 font-medium\",\n          children: \"Eraser Size\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-gray-500 dark:text-gray-400\",\n          children: [eraserSize, \"px\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"range\",\n        min: \"8\",\n        max: \"64\",\n        value: eraserSize,\n        onChange: e => setEraserSize(Number(e.target.value)),\n        className: \"w-full\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 283,\n    columnNumber: 5\n  }, this);\n}\n_c6 = RightToolbar;\nfunction isNearPoint(x, y, pt, threshold = 8) {\n  return Math.hypot(x - pt.x, y - pt.y) < threshold;\n}\nfunction Draggable({\n  x,\n  y,\n  children,\n  onDrag,\n  style,\n  ...props\n}) {\n  _s5();\n  const [dragging, setDragging] = useState(false);\n  const [position, setPosition] = useState({\n    x,\n    y\n  });\n  const handlePointerDown = e => {\n    e.stopPropagation();\n    setDragging(true);\n  };\n  const handlePointerMove = e => {\n    if (dragging) {\n      const newX = e.clientX;\n      const newY = e.clientY;\n      setPosition({\n        x: newX,\n        y: newY\n      });\n      onDrag && onDrag({\n        x: newX,\n        y: newY\n      });\n    }\n  };\n  const handlePointerUp = () => setDragging(false);\n  useEffect(() => {\n    if (dragging) {\n      window.addEventListener('pointermove', handlePointerMove);\n      window.addEventListener('pointerup', handlePointerUp);\n    }\n    return () => {\n      window.removeEventListener('pointermove', handlePointerMove);\n      window.removeEventListener('pointerup', handlePointerUp);\n    };\n  }, [dragging]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: 'absolute',\n      left: position.x,\n      top: position.y,\n      cursor: dragging ? 'grabbing' : 'grab',\n      transition: dragging ? 'none' : 'all 0.15s ease-out',\n      ...style\n    },\n    onPointerDown: handlePointerDown,\n    ...props,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 400,\n    columnNumber: 5\n  }, this);\n}\n\n// AddImageModal component\n_s5(Draggable, \"dr11v5MpfF1X7siHAFuKOo1K8cA=\");\n_c7 = Draggable;\nfunction AddImageModal({\n  open,\n  onClose,\n  onAdd,\n  position,\n  isDark\n}) {\n  _s6();\n  const [tab, setTab] = useState('url');\n  const [url, setUrl] = useState('');\n  const [file, setFile] = useState(null);\n  const [gifs, setGifs] = useState([]);\n  const [gifQuery, setGifQuery] = useState('');\n  const [loading, setLoading] = useState(false);\n  useEffect(() => {\n    if (tab === 'gif' && gifQuery) {\n      setLoading(true);\n      fetch(`https://api.giphy.com/v1/gifs/search?api_key=dc6zaTOxFJmzC&q=${encodeURIComponent(gifQuery)}&limit=12`).then(res => res.json()).then(data => {\n        setGifs(data.data);\n        setLoading(false);\n      });\n    }\n  }, [tab, gifQuery]);\n  if (!open) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 z-50 flex items-center justify-center bg-black/30 dark:bg-black/60\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `bg-white dark:bg-zinc-900 rounded-xl shadow-xl p-6 w-[370px] max-w-full relative border border-gray-200 dark:border-zinc-700`,\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onClose,\n        className: \"absolute top-3 right-3 text-2xl text-gray-400 hover:text-gray-700 dark:hover:text-gray-200\",\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 443,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4 flex gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setTab('url'),\n          className: `px-4 py-1.5 rounded-t-lg border ${tab === 'url' ? 'bg-gray-100 dark:bg-zinc-800 border-gray-300 dark:border-zinc-700 font-semibold' : 'bg-transparent border-transparent'}`,\n          children: \"URL\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setTab('upload'),\n          className: `px-4 py-1.5 rounded-t-lg border ${tab === 'upload' ? 'bg-gray-100 dark:bg-zinc-800 border-gray-300 dark:border-zinc-700 font-semibold' : 'bg-transparent border-transparent'}`,\n          children: \"Upload\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setTab('gif'),\n          className: `px-4 py-1.5 rounded-t-lg border ${tab === 'gif' ? 'bg-gray-100 dark:bg-zinc-800 border-gray-300 dark:border-zinc-700 font-semibold' : 'bg-transparent border-transparent'}`,\n          children: \"GIF\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 9\n      }, this), tab === 'url' && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm mb-2 font-medium text-gray-700 dark:text-gray-200\",\n          children: \"Image URL\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: url,\n          onChange: e => setUrl(e.target.value),\n          placeholder: \"https://example.com/image.jpg\",\n          className: \"w-full px-3 py-2 rounded border border-gray-300 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-gray-100 mb-4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"w-full py-2 rounded bg-gray-300 dark:bg-zinc-700 text-gray-700 dark:text-gray-200 font-semibold disabled:opacity-60\",\n          disabled: !url,\n          onClick: () => {\n            onAdd({\n              type: 'url',\n              src: url,\n              position\n            });\n            onClose();\n          },\n          children: \"Add Image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 11\n      }, this), tab === 'upload' && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm mb-2 font-medium text-gray-700 dark:text-gray-200\",\n          children: \"Upload Image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 458,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \"image/*\",\n          onChange: e => setFile(e.target.files[0]),\n          className: \"mb-4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"w-full py-2 rounded bg-gray-300 dark:bg-zinc-700 text-gray-700 dark:text-gray-200 font-semibold disabled:opacity-60\",\n          disabled: !file,\n          onClick: () => {\n            const reader = new FileReader();\n            reader.onload = ev => {\n              onAdd({\n                type: 'upload',\n                src: ev.target.result,\n                position\n              });\n              onClose();\n            };\n            reader.readAsDataURL(file);\n          },\n          children: \"Add Image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 457,\n        columnNumber: 11\n      }, this), tab === 'gif' && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm mb-2 font-medium text-gray-700 dark:text-gray-200\",\n          children: \"Search GIFs\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 469,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: gifQuery,\n          onChange: e => setGifQuery(e.target.value),\n          placeholder: \"funny cat\",\n          className: \"w-full px-3 py-2 rounded border border-gray-300 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-gray-100 mb-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-32 overflow-y-auto grid grid-cols-3 gap-2 mb-2\",\n          children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-span-3 text-center text-gray-400\",\n            children: \"Loading...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 472,\n            columnNumber: 26\n          }, this) : gifs.map(gif => /*#__PURE__*/_jsxDEV(\"img\", {\n            src: gif.images.fixed_width_small.url,\n            alt: gif.title,\n            className: \"rounded cursor-pointer hover:scale-105 transition\",\n            onClick: () => {\n              onAdd({\n                type: 'gif',\n                src: gif.images.original.url,\n                position\n              });\n              onClose();\n            }\n          }, gif.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 474,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 468,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 442,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 441,\n    columnNumber: 5\n  }, this);\n}\n_s6(AddImageModal, \"eRfRu4pAb+sc2sdRzn99Up2DnRw=\");\n_c8 = AddImageModal;\nfunction StickyNote({\n  id,\n  x,\n  y,\n  width,\n  height,\n  rotation,\n  color,\n  font,\n  text,\n  isEditing,\n  isSelected,\n  onClick,\n  onChange,\n  onEdit,\n  onDelete,\n  onDrag,\n  onResize,\n  onRotate,\n  editingRef,\n  onSelectionChange\n}) {\n  _s7();\n  const [dragging, setDragging] = useState(false);\n  const [resizing, setResizing] = useState(false);\n  const [rotating, setRotating] = useState(false);\n  const [local, setLocal] = useState({\n    x,\n    y,\n    width,\n    height,\n    rotation\n  });\n  const noteRef = useRef();\n  const contentRef = useRef();\n\n  // Track selection for rich text\n  const [selection, setSelection] = useState(null);\n\n  // Drag logic\n  function handleDrag(e, info) {\n    setLocal(l => ({\n      ...l,\n      x: info.point.x,\n      y: info.point.y\n    }));\n    if (onDrag) onDrag({\n      x: info.point.x,\n      y: info.point.y\n    });\n  }\n\n  // Resize logic\n  function handleResize(e) {\n    e.stopPropagation();\n    setResizing(true);\n    const startX = e.clientX;\n    const startY = e.clientY;\n    const startW = local.width;\n    const startH = local.height;\n    function onMove(ev) {\n      const newW = Math.max(80, startW + (ev.clientX - startX));\n      const newH = Math.max(40, startH + (ev.clientY - startY));\n      setLocal(l => ({\n        ...l,\n        width: newW,\n        height: newH\n      }));\n      if (onResize) onResize({\n        width: newW,\n        height: newH\n      });\n    }\n    function onUp() {\n      setResizing(false);\n      window.removeEventListener('pointermove', onMove);\n      window.removeEventListener('pointerup', onUp);\n    }\n    window.addEventListener('pointermove', onMove);\n    window.addEventListener('pointerup', onUp);\n  }\n\n  // Rotate logic\n  function handleRotate(e) {\n    e.stopPropagation();\n    setRotating(true);\n    const rect = noteRef.current.getBoundingClientRect();\n    const centerX = rect.left + rect.width / 2;\n    const centerY = rect.top + rect.height / 2;\n    function onMove(ev) {\n      const dx = ev.clientX - centerX;\n      const dy = ev.clientY - centerY;\n      const angle = Math.atan2(dy, dx) * 180 / Math.PI;\n      setLocal(l => ({\n        ...l,\n        rotation: angle\n      }));\n      if (onRotate) onRotate({\n        rotation: angle\n      });\n    }\n    function onUp() {\n      setRotating(false);\n      window.removeEventListener('pointermove', onMove);\n      window.removeEventListener('pointerup', onUp);\n    }\n    window.addEventListener('pointermove', onMove);\n    window.addEventListener('pointerup', onUp);\n  }\n\n  // Handle selection change\n  function handleSelection() {\n    const sel = window.getSelection();\n    if (sel && sel.rangeCount > 0 && contentRef.current && contentRef.current.contains(sel.anchorNode)) {\n      setSelection(sel.getRangeAt(0));\n      if (onSelectionChange) onSelectionChange(sel.getRangeAt(0));\n    } else {\n      setSelection(null);\n      if (onSelectionChange) onSelectionChange(null);\n    }\n  }\n  useEffect(() => {\n    if (editingRef && isEditing) {\n      editingRef.current = contentRef.current;\n    }\n  }, [editingRef, isEditing]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: noteRef,\n    className: `absolute shadow-lg rounded-lg ${isSelected ? 'ring-2 ring-blue-500 ring-offset-2' : ''}`,\n    style: {\n      left: local.x,\n      top: local.y,\n      width: local.width,\n      height: local.height,\n      background: color,\n      fontFamily: font,\n      transform: `rotate(${local.rotation || 0}deg)`,\n      transition: dragging || resizing || rotating ? 'none' : 'box-shadow 0.2s, transform 0.2s',\n      zIndex: dragging ? 100 : 10,\n      boxShadow: dragging ? '0 8px 32px 0 rgba(0,0,0,0.18)' : '0 2px 8px 0 rgba(0,0,0,0.10)',\n      userSelect: isEditing ? 'text' : 'none'\n    },\n    drag: true,\n    dragMomentum: false,\n    dragElastic: 0.18,\n    onDragStart: () => setDragging(true),\n    onDragEnd: (e, info) => {\n      setDragging(false);\n      if (onDrag) onDrag({\n        x: info.point.x,\n        y: info.point.y\n      });\n    },\n    onDrag: handleDrag,\n    onClick: onClick,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-1 px-2 py-1 bg-white/60 dark:bg-zinc-900/60 rounded-t-lg\",\n      style: {\n        cursor: 'move',\n        borderBottom: '1px solid #eee'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onEdit,\n        className: \"ml-auto text-xs px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-zinc-800\",\n        children: \"\\u270F\\uFE0F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 594,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onDelete,\n        className: \"text-xs px-1 py-0.5 rounded hover:bg-red-100 dark:hover:bg-red-900\",\n        children: \"\\uD83D\\uDDD1\\uFE0F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 595,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onPointerDown: handleRotate,\n        className: \"text-xs px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-zinc-800 cursor-alias\",\n        children: \"\\u27F3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 596,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 593,\n      columnNumber: 7\n    }, this), isEditing ? /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: contentRef,\n      contentEditable: true,\n      suppressContentEditableWarning: true,\n      className: \"w-full h-full bg-transparent resize-none outline-none p-2 text-base rounded-b-lg\",\n      style: {\n        fontFamily: font,\n        background: 'transparent',\n        minHeight: 40,\n        minWidth: 80\n      },\n      onBlur: onEdit,\n      onInput: e => onChange && onChange(e.currentTarget.innerHTML),\n      onSelect: handleSelection,\n      onKeyUp: handleSelection,\n      onMouseUp: handleSelection,\n      dangerouslySetInnerHTML: {\n        __html: text\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 600,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full h-full p-2 text-base rounded-b-lg cursor-pointer\",\n      style: {\n        fontFamily: font,\n        background: 'transparent',\n        minHeight: 40,\n        minWidth: 80\n      },\n      onDoubleClick: onEdit,\n      dangerouslySetInnerHTML: {\n        __html: text\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 614,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      onPointerDown: handleResize,\n      className: \"absolute right-1.5 bottom-1.5 w-3 h-3 bg-white dark:bg-zinc-800 border border-gray-300 dark:border-zinc-700 rounded cursor-se-resize\",\n      style: {\n        zIndex: 20\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 622,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 568,\n    columnNumber: 5\n  }, this);\n}\n_s7(StickyNote, \"XhQuA++PR/r/rMZnsV8a0WVc3ws=\");\n_c9 = StickyNote;\nconst SOCKET_SERVER_URL = \"http://localhost:4000\"; // Change if deploying\n\nexport default function CanvasPage() {\n  _s8();\n  var _elements$stickyNotes, _elements$textBoxes$f, _canvasRef$current2, _canvasRef$current3;\n  // Initialize boardId first\n  const [boardId] = useState(() => {\n    // Use URL param or random for now\n    const urlId = window.location.hash.replace('#', '');\n    if (urlId) return urlId;\n    const randomId = Math.random().toString(36).slice(2, 10);\n    window.location.hash = randomId;\n    return randomId;\n  });\n\n  // Unified state for all elements\n  const [elements, setElements] = useState(() => {\n    try {\n      // Load saved state from localStorage on initial render\n      const savedState = localStorage.getItem(`canvas-state-${boardId}`);\n      return savedState ? JSON.parse(savedState) : {\n        lines: [],\n        stickyNotes: [],\n        images: [],\n        textBoxes: []\n      };\n    } catch (error) {\n      console.error('Error loading saved state:', error);\n      return {\n        lines: [],\n        stickyNotes: [],\n        images: [],\n        textBoxes: []\n      };\n    }\n  });\n  const [drawing, setDrawing] = useState(false);\n  // Initialize undo/redo stacks from localStorage\n  const [undoStack, setUndoStack] = useState(() => {\n    try {\n      const savedUndo = localStorage.getItem(`undo-stack-${boardId}`);\n      return savedUndo ? JSON.parse(savedUndo) : [];\n    } catch (error) {\n      console.error('Error loading undo stack:', error);\n      return [];\n    }\n  });\n  const [redoStack, setRedoStack] = useState(() => {\n    try {\n      const savedRedo = localStorage.getItem(`redo-stack-${boardId}`);\n      return savedRedo ? JSON.parse(savedRedo) : [];\n    } catch (error) {\n      console.error('Error loading redo stack:', error);\n      return [];\n    }\n  });\n\n  // Save undo/redo stacks to localStorage whenever they change\n  useEffect(() => {\n    try {\n      localStorage.setItem(`undo-stack-${boardId}`, JSON.stringify(undoStack));\n    } catch (error) {\n      console.error('Error saving undo stack:', error);\n    }\n  }, [undoStack, boardId]);\n  useEffect(() => {\n    try {\n      localStorage.setItem(`redo-stack-${boardId}`, JSON.stringify(redoStack));\n    } catch (error) {\n      console.error('Error saving redo stack:', error);\n    }\n  }, [redoStack, boardId]);\n  const [eraserSize, setEraserSize] = useState(16);\n  const [eraserPos, setEraserPos] = useState(null);\n  const [eraserPreview, setEraserPreview] = useState(false);\n  const [editingTextId, setEditingTextId] = useState(null);\n  const [editingStickyId, setEditingStickyId] = useState(null);\n  const [selectedStickyId, setSelectedStickyId] = useState(null);\n  const [selectedTextId, setSelectedTextId] = useState(null);\n  const [tool, setTool] = useState('draw');\n  const [color, setColor] = useState(\"#222\");\n  const [opacity, setOpacity] = useState(1);\n  const canvasRef = useRef(null);\n  const isDark = useIsDarkMode();\n  const [showAddImageModal, setShowAddImageModal] = useState(false);\n  const [pendingImagePos, setPendingImagePos] = useState(null);\n  const [mousePos, setMousePos] = useState({\n    x: 0,\n    y: 0\n  });\n  const socketRef = useRef(null);\n  const [stickyFont, setStickyFont] = useState('Inter, sans-serif');\n  const editingStickyRef = useRef(null);\n  const [editingStickySelection, setEditingStickySelection] = useState(null);\n  const editingTextRef = useRef(null);\n  const [editingTextSelection, setEditingTextSelection] = useState(null);\n  const [lastEraserPos, setLastEraserPos] = useState(null);\n  const [showDownloadModal, setShowDownloadModal] = useState(false);\n\n  // Save state to localStorage whenever elements change\n  useEffect(() => {\n    try {\n      localStorage.setItem(`canvas-state-${boardId}`, JSON.stringify(elements));\n    } catch (error) {\n      console.error('Error saving state:', error);\n    }\n  }, [elements, boardId]);\n\n  // Helper: push to undo stack\n  const pushToUndo = current => {\n    setUndoStack(prev => [...prev, current]);\n    setRedoStack([]);\n  };\n\n  // Erase logic for all elements\n  function eraseAt(x, y) {\n    setElements(prev => {\n      // Erase lines\n      const lines = prev.lines.filter(line => !line.points.some(pt => Math.hypot(x - pt.x, y - pt.y) < eraserSize / 2));\n      // Erase sticky notes\n      const stickyNotes = prev.stickyNotes.filter(note => !isInBox(x, y, note.x, note.y, 120, 80));\n      // Erase images\n      const images = prev.images.filter(img => !isInBox(x, y, img.x, img.y, img.width, img.height));\n      // Erase text boxes\n      const textBoxes = prev.textBoxes.filter(tb => !isInBox(x, y, tb.x, tb.y, 120, 40));\n      return {\n        lines,\n        stickyNotes,\n        images,\n        textBoxes\n      };\n    });\n  }\n  function isInBox(x, y, bx, by, bw, bh) {\n    return x >= bx && x <= bx + bw && y >= by && y <= by + bh;\n  }\n\n  // Add mouse move handler with throttling\n  const handleMouseMove = e => {\n    var _canvasRef$current;\n    const rect = (_canvasRef$current = canvasRef.current) === null || _canvasRef$current === void 0 ? void 0 : _canvasRef$current.getBoundingClientRect();\n    if (rect) {\n      const x = e.clientX - rect.left;\n      const y = e.clientY - rect.top;\n      requestAnimationFrame(() => {\n        setMousePos({\n          x,\n          y\n        });\n        if (tool === 'eraser') {\n          setEraserPos({\n            x,\n            y\n          });\n        }\n      });\n    }\n  };\n\n  // Update pointer move handler with throttling\n  const handlePointerMove = e => {\n    const rect = canvasRef.current.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    requestAnimationFrame(() => {\n      setMousePos({\n        x,\n        y\n      });\n      if (tool === 'eraser') {\n        setEraserPos({\n          x,\n          y\n        });\n      }\n    });\n    if (!drawing) return;\n    if (tool === 'draw') {\n      setElements(prev => {\n        const newLines = [...prev.lines];\n        newLines[newLines.length - 1].points.push({\n          x,\n          y\n        });\n        return {\n          ...prev,\n          lines: newLines\n        };\n      });\n    } else if (tool === 'eraser') {\n      // Interpolate between last and current position for smooth erasing\n      if (lastEraserPos) {\n        const steps = Math.ceil(Math.hypot(x - lastEraserPos.x, y - lastEraserPos.y) / (eraserSize / 2));\n        for (let i = 1; i <= steps; i++) {\n          const t = i / steps;\n          const ix = lastEraserPos.x + (x - lastEraserPos.x) * t;\n          const iy = lastEraserPos.y + (y - lastEraserPos.y) * t;\n          eraseAt(ix, iy);\n        }\n      } else {\n        eraseAt(x, y);\n      }\n      setLastEraserPos({\n        x,\n        y\n      });\n    }\n  };\n  const handlePointerDown = e => {\n    const rect = canvasRef.current.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    if (tool === 'draw') {\n      pushToUndo(elements);\n      setElements(prev => ({\n        ...prev,\n        lines: [...prev.lines, {\n          points: [{\n            x,\n            y\n          }],\n          color,\n          opacity\n        }]\n      }));\n      setDrawing(true);\n    } else if (tool === 'eraser') {\n      pushToUndo(elements);\n      eraseAt(x, y);\n      setDrawing(true);\n      setEraserPos({\n        x,\n        y\n      });\n      setLastEraserPos({\n        x,\n        y\n      });\n      setEraserPreview(true);\n    }\n  };\n  const handlePointerUp = () => {\n    setDrawing(false);\n    setEraserPos(null);\n    setLastEraserPos(null);\n    setEraserPreview(false);\n  };\n\n  // Add sticky note, image, or text box\n  const handleCanvasPointerDown = e => {\n    const rect = canvasRef.current.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    if (tool === 'sticky') {\n      pushToUndo(elements);\n      setElements(prev => ({\n        ...prev,\n        stickyNotes: [...prev.stickyNotes, {\n          id: Date.now(),\n          x,\n          y,\n          text: \"Sticky note\"\n        }]\n      }));\n    } else if (tool === 'text') {\n      pushToUndo(elements);\n      setElements(prev => ({\n        ...prev,\n        textBoxes: [...prev.textBoxes, {\n          id: Date.now(),\n          x,\n          y,\n          text: \"Text\"\n        }]\n      }));\n    } else {\n      handlePointerDown(e);\n    }\n  };\n\n  // Add handler for adding image from modal\n  function handleAddImage({\n    type,\n    src,\n    position\n  }) {\n    pushToUndo(elements);\n    setElements(prev => ({\n      ...prev,\n      images: [...prev.images, {\n        id: Date.now(),\n        x: position.x,\n        y: position.y,\n        src,\n        width: 120,\n        height: 90\n      }]\n    }));\n  }\n\n  // Undo/Redo logic\n  const handleUndo = useCallback(() => {\n    setUndoStack(prevUndo => {\n      if (prevUndo.length === 0) return prevUndo;\n      setRedoStack(prevRedo => [...prevRedo, elements]);\n      const prevElements = prevUndo[prevUndo.length - 1];\n      setElements(prevElements);\n      return prevUndo.slice(0, -1);\n    });\n  }, [elements]);\n  const handleRedo = useCallback(() => {\n    setRedoStack(prevRedo => {\n      if (prevRedo.length === 0) return prevRedo;\n      setUndoStack(prevUndo => [...prevUndo, elements]);\n      const nextElements = prevRedo[prevRedo.length - 1];\n      setElements(nextElements);\n      return prevRedo.slice(0, -1);\n    });\n  }, [elements]);\n\n  // Keyboard shortcuts for undo/redo\n  useEffect(() => {\n    const handleKeyDown = e => {\n      if ((e.ctrlKey || e.metaKey) && e.key === \"z\") {\n        e.preventDefault();\n        handleUndo();\n      } else if ((e.ctrlKey || e.metaKey) && (e.key === \"y\" || e.shiftKey && e.key === \"z\")) {\n        e.preventDefault();\n        handleRedo();\n      }\n    };\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\n  }, [handleUndo, handleRedo]);\n\n  // Draw lines on canvas\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.lineCap = \"round\";\n    ctx.lineJoin = \"round\";\n    elements.lines.forEach(line => {\n      ctx.save();\n      ctx.strokeStyle = line.color;\n      ctx.globalAlpha = line.opacity !== undefined ? line.opacity : 1;\n      ctx.lineWidth = 2.5;\n      ctx.beginPath();\n      line.points.forEach((pt, i) => {\n        if (i === 0) ctx.moveTo(pt.x, pt.y);else ctx.lineTo(pt.x, pt.y);\n      });\n      ctx.stroke();\n      ctx.restore();\n    });\n  }, [elements.lines]);\n\n  // Replace setTool usage to intercept 'image' tool selection\n  function handleToolbarToolSelect(selectedTool) {\n    setTool(selectedTool);\n    if (selectedTool === 'image') {\n      // Center of viewport\n      const x = window.innerWidth / 2 - 60;\n      const y = window.innerHeight / 2 - 45;\n      setPendingImagePos({\n        x,\n        y\n      });\n      setShowAddImageModal(true);\n    }\n  }\n\n  // --- SOCKET.IO LOGIC ---\n  useEffect(() => {\n    const socket = io(SOCKET_SERVER_URL);\n    socketRef.current = socket;\n    socket.emit('join-board', boardId);\n    socket.on('board-state', data => {\n      setElements(data);\n    });\n    socket.on('board-update', data => {\n      setElements(data);\n    });\n    return () => {\n      socket.disconnect();\n    };\n  }, [boardId]);\n\n  // Broadcast changes to others\n  useEffect(() => {\n    if (socketRef.current) {\n      socketRef.current.emit('board-update', {\n        boardId,\n        data: elements\n      });\n    }\n  }, [elements]);\n  function applyStyleToSelection(styleType, value) {\n    if (editingStickyRef.current && editingStickySelection) {\n      editingStickyRef.current.focus();\n      document.getSelection().removeAllRanges();\n      document.getSelection().addRange(editingStickySelection);\n      if (styleType === 'color') {\n        document.execCommand('foreColor', false, value);\n      } else if (styleType === 'font') {\n        document.execCommand('fontName', false, value);\n      }\n    }\n  }\n  function handleTextSelection() {\n    const sel = window.getSelection();\n    if (sel && sel.rangeCount > 0 && editingTextRef.current && editingTextRef.current.contains(sel.anchorNode)) {\n      setEditingTextSelection(sel.getRangeAt(0));\n    } else {\n      setEditingTextSelection(null);\n    }\n  }\n  function applyStyleToTextSelection(styleType, value) {\n    if (editingTextRef.current && editingTextSelection) {\n      editingTextRef.current.focus();\n      document.getSelection().removeAllRanges();\n      document.getSelection().addRange(editingTextSelection);\n      if (styleType === 'color') {\n        document.execCommand('foreColor', false, value);\n      } else if (styleType === 'font') {\n        document.execCommand('fontName', false, value);\n      }\n    }\n  }\n\n  // Download handlers\n  const handleDownload = async format => {\n    try {\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n\n      // Create a temporary canvas to combine all elements\n      const tempCanvas = document.createElement('canvas');\n      tempCanvas.width = canvas.width;\n      tempCanvas.height = canvas.height;\n      const tempCtx = tempCanvas.getContext('2d');\n\n      // Draw background\n      tempCtx.fillStyle = isDark ? '#18181b' : '#fafafa';\n      tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);\n\n      // Draw all elements\n      // Draw lines\n      elements.lines.forEach(line => {\n        tempCtx.save();\n        tempCtx.strokeStyle = line.color;\n        tempCtx.globalAlpha = line.opacity !== undefined ? line.opacity : 1;\n        tempCtx.lineWidth = 2.5;\n        tempCtx.beginPath();\n        line.points.forEach((pt, i) => {\n          if (i === 0) tempCtx.moveTo(pt.x, pt.y);else tempCtx.lineTo(pt.x, pt.y);\n        });\n        tempCtx.stroke();\n        tempCtx.restore();\n      });\n\n      // Draw sticky notes\n      elements.stickyNotes.forEach(note => {\n        tempCtx.save();\n        tempCtx.fillStyle = note.color || '#fff';\n        tempCtx.fillRect(note.x, note.y, 120, 80);\n        tempCtx.fillStyle = '#000';\n        tempCtx.font = '14px sans-serif';\n        tempCtx.fillText(note.text, note.x + 10, note.y + 20);\n        tempCtx.restore();\n      });\n\n      // Draw text boxes\n      elements.textBoxes.forEach(text => {\n        tempCtx.save();\n        tempCtx.fillStyle = text.color || '#000';\n        tempCtx.font = '14px sans-serif';\n        tempCtx.fillText(text.text, text.x, text.y);\n        tempCtx.restore();\n      });\n\n      // Draw images\n      const imagePromises = elements.images.map(img => {\n        return new Promise(resolve => {\n          const image = new Image();\n          image.crossOrigin = 'anonymous';\n          image.onload = () => {\n            tempCtx.drawImage(image, img.x, img.y, img.width, img.height);\n            resolve();\n          };\n          image.onerror = () => resolve();\n          image.src = img.src;\n        });\n      });\n      await Promise.all(imagePromises);\n      if (format === 'pdf') {\n        // Convert to PDF using jsPDF\n        const {\n          jsPDF\n        } = await import('jspdf');\n        const pdf = new jsPDF({\n          orientation: 'landscape',\n          unit: 'px',\n          format: [tempCanvas.width, tempCanvas.height]\n        });\n        pdf.addImage(tempCanvas.toDataURL('image/jpeg', 1.0), 'JPEG', 0, 0, tempCanvas.width, tempCanvas.height);\n        pdf.save('canvas-export.pdf');\n      } else {\n        // Download as JPG\n        const link = document.createElement('a');\n        link.download = 'canvas-export.jpg';\n        link.href = tempCanvas.toDataURL('image/jpeg', 0.8);\n        link.click();\n      }\n      setShowDownloadModal(false);\n    } catch (error) {\n      console.error('Error downloading:', error);\n      alert('Error downloading the canvas. Please try again.');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-screen w-screen relative bg-gray-50 dark:bg-dark\",\n    onMouseMove: handleMouseMove,\n    children: [/*#__PURE__*/_jsxDEV(LogoStandalone, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1119,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TopControlsBox, {\n      onUndo: handleUndo,\n      onRedo: handleRedo,\n      boardId: boardId,\n      onDownload: handleDownload\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1120,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(RightToolbar, {\n      tool: tool,\n      eraserSize: eraserSize,\n      setEraserSize: setEraserSize,\n      color: color,\n      setColor: setColor,\n      opacity: opacity,\n      setOpacity: setOpacity,\n      selectedStickyId: selectedStickyId,\n      selectedTextId: selectedTextId,\n      stickyFont: selectedStickyId ? (_elements$stickyNotes = elements.stickyNotes.find(n => n.id === selectedStickyId)) === null || _elements$stickyNotes === void 0 ? void 0 : _elements$stickyNotes.font : '',\n      textFont: selectedTextId ? (_elements$textBoxes$f = elements.textBoxes.find(t => t.id === selectedTextId)) === null || _elements$textBoxes$f === void 0 ? void 0 : _elements$textBoxes$f.font : '',\n      onStickyColorChange: newColor => {\n        if (!selectedStickyId) return;\n        pushToUndo(elements);\n        setElements(prev => ({\n          ...prev,\n          stickyNotes: prev.stickyNotes.map(n => n.id === selectedStickyId ? {\n            ...n,\n            color: newColor\n          } : n)\n        }));\n        setColor(newColor);\n      },\n      onStickyFontChange: newFont => {\n        if (!selectedStickyId) return;\n        pushToUndo(elements);\n        setElements(prev => ({\n          ...prev,\n          stickyNotes: prev.stickyNotes.map(n => n.id === selectedStickyId ? {\n            ...n,\n            font: newFont\n          } : n)\n        }));\n        setStickyFont(newFont);\n      },\n      onTextColorChange: newColor => {\n        if (!selectedTextId) return;\n        pushToUndo(elements);\n        setElements(prev => ({\n          ...prev,\n          textBoxes: prev.textBoxes.map(t => t.id === selectedTextId ? {\n            ...t,\n            color: newColor\n          } : t)\n        }));\n        setColor(newColor);\n      },\n      onTextFontChange: newFont => {\n        if (!selectedTextId) return;\n        pushToUndo(elements);\n        setElements(prev => ({\n          ...prev,\n          textBoxes: prev.textBoxes.map(t => t.id === selectedTextId ? {\n            ...t,\n            font: newFont\n          } : t)\n        }));\n      },\n      elements: elements\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1126,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      width: window.innerWidth,\n      height: window.innerHeight,\n      className: \"block absolute top-0 left-0 w-full h-full\",\n      style: {\n        cursor: tool === 'draw' ? 'crosshair' : tool === 'eraser' ? 'none' : 'default',\n        background: 'transparent'\n      },\n      onPointerDown: handleCanvasPointerDown,\n      onPointerMove: handlePointerMove,\n      onPointerUp: handlePointerUp,\n      onPointerLeave: handlePointerUp\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1175,\n      columnNumber: 7\n    }, this), elements.stickyNotes.map(note => /*#__PURE__*/_jsxDEV(StickyNote, {\n      id: note.id,\n      x: note.x,\n      y: note.y,\n      width: 120,\n      height: 80,\n      rotation: 0,\n      color: note.color || \"#fff\",\n      font: note.font || \"Inter, sans-serif\",\n      text: note.text,\n      isEditing: editingStickyId === note.id,\n      isSelected: selectedStickyId === note.id,\n      onClick: () => setSelectedStickyId(note.id),\n      onChange: newText => {\n        pushToUndo(elements);\n        setElements(prev => ({\n          ...prev,\n          stickyNotes: prev.stickyNotes.map(n => n.id === note.id ? {\n            ...n,\n            text: newText\n          } : n)\n        }));\n      },\n      onEdit: () => setEditingStickyId(note.id),\n      onDelete: () => {\n        pushToUndo(elements);\n        setElements(prev => ({\n          ...prev,\n          stickyNotes: prev.stickyNotes.filter(n => n.id !== note.id)\n        }));\n        if (selectedStickyId === note.id) setSelectedStickyId(null);\n      },\n      onDrag: pos => {\n        pushToUndo(elements);\n        setElements(prev => ({\n          ...prev,\n          stickyNotes: prev.stickyNotes.map(n => n.id === note.id ? {\n            ...n,\n            ...pos\n          } : n)\n        }));\n      },\n      onResize: size => {\n        pushToUndo(elements);\n        setElements(prev => ({\n          ...prev,\n          stickyNotes: prev.stickyNotes.map(n => n.id === note.id ? {\n            ...n,\n            ...size\n          } : n)\n        }));\n      },\n      onRotate: rotation => {\n        pushToUndo(elements);\n        setElements(prev => ({\n          ...prev,\n          stickyNotes: prev.stickyNotes.map(n => n.id === note.id ? {\n            ...n,\n            rotation\n          } : n)\n        }));\n      },\n      editingRef: editingStickyId === note.id ? editingStickyRef : undefined,\n      onSelectionChange: editingStickyId === note.id ? setEditingStickySelection : undefined\n    }, note.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1191,\n      columnNumber: 9\n    }, this)), elements.images.map(img => /*#__PURE__*/_jsxDEV(Draggable, {\n      x: img.x,\n      y: img.y,\n      onDrag: pos => {\n        pushToUndo(elements);\n        setElements(prev => ({\n          ...prev,\n          images: prev.images.map(i => i.id === img.id ? {\n            ...i,\n            ...pos\n          } : i)\n        }));\n      },\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: img.src,\n        alt: \"uploaded\",\n        style: {\n          width: img.width,\n          height: img.height,\n          borderRadius: 8,\n          boxShadow: '0 2px 8px rgba(0,0,0,0.12)'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1260,\n        columnNumber: 11\n      }, this)\n    }, img.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1248,\n      columnNumber: 9\n    }, this)), elements.textBoxes.map(tb => /*#__PURE__*/_jsxDEV(Draggable, {\n      x: tb.x,\n      y: tb.y,\n      onDrag: pos => {\n        pushToUndo(elements);\n        setElements(prev => ({\n          ...prev,\n          textBoxes: prev.textBoxes.map(t => t.id === tb.id ? {\n            ...t,\n            ...pos\n          } : t)\n        }));\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `rounded bg-white/80 dark:bg-zinc-900/80 px-2 py-1 text-base shadow border border-gray-200 dark:border-zinc-700 cursor-pointer ${selectedTextId === tb.id ? 'ring-2 ring-blue-500 ring-offset-2' : ''}`,\n        style: {\n          fontFamily: tb.font || 'inherit',\n          fontWeight: 500,\n          minWidth: 60,\n          color: tb.color || '#222',\n          transition: 'box-shadow 0.2s, transform 0.2s'\n        },\n        onClick: () => setSelectedTextId(tb.id),\n        children: editingTextId === tb.id ? /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: editingTextId === tb.id ? editingTextRef : undefined,\n          contentEditable: true,\n          suppressContentEditableWarning: true,\n          className: \"bg-transparent outline-none w-full\",\n          style: {\n            fontFamily: tb.font || 'inherit',\n            color: tb.color || '#222'\n          },\n          onBlur: () => setEditingTextId(null),\n          onInput: e => setElements(prev => ({\n            ...prev,\n            textBoxes: prev.textBoxes.map(t => t.id === tb.id ? {\n              ...t,\n              text: e.currentTarget.innerHTML\n            } : t)\n          })),\n          onSelect: handleTextSelection,\n          onKeyUp: handleTextSelection,\n          onMouseUp: handleTextSelection,\n          dangerouslySetInnerHTML: {\n            __html: tb.text\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1289,\n          columnNumber: 15\n        }, this) : tb.text\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1277,\n        columnNumber: 11\n      }, this)\n    }, tb.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1265,\n      columnNumber: 9\n    }, this)), tool === 'eraser' && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        left: mousePos.x + ((_canvasRef$current2 = canvasRef.current) === null || _canvasRef$current2 === void 0 ? void 0 : _canvasRef$current2.getBoundingClientRect().left) - eraserSize / 2,\n        top: mousePos.y + ((_canvasRef$current3 = canvasRef.current) === null || _canvasRef$current3 === void 0 ? void 0 : _canvasRef$current3.getBoundingClientRect().top) - eraserSize / 2,\n        width: eraserSize,\n        height: eraserSize,\n        pointerEvents: 'none',\n        borderRadius: '50%',\n        border: '2px solid #f87171',\n        background: isDark ? 'rgba(255,255,255,0.08)' : 'rgba(0,0,0,0.08)',\n        boxShadow: '0 0 8px 2px rgba(248,113,113,0.2)',\n        zIndex: 1000,\n        transition: 'transform 0.05s ease-out',\n        transform: 'translate3d(0, 0, 0)',\n        willChange: 'transform',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: '2px',\n          height: '2px',\n          background: '#f87171',\n          borderRadius: '50%',\n          boxShadow: '0 0 2px 1px rgba(248,113,113,0.5)'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1335,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1313,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(BottomToolbar, {\n      tool: tool,\n      setTool: handleToolbarToolSelect\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1346,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AddImageModal, {\n      open: showAddImageModal,\n      onClose: () => setShowAddImageModal(false),\n      onAdd: handleAddImage,\n      position: pendingImagePos,\n      isDark: isDark\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1347,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1115,\n    columnNumber: 5\n  }, this);\n}\n_s8(CanvasPage, \"PCFh62DJFhKoX5ur44LLdj+ZFZY=\", false, function () {\n  return [useIsDarkMode];\n});\n_c0 = CanvasPage;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0;\n$RefreshReg$(_c, \"DarkModeToggleTop\");\n$RefreshReg$(_c2, \"DownloadModal\");\n$RefreshReg$(_c3, \"TopControlsBox\");\n$RefreshReg$(_c4, \"LogoStandalone\");\n$RefreshReg$(_c5, \"BottomToolbar\");\n$RefreshReg$(_c6, \"RightToolbar\");\n$RefreshReg$(_c7, \"Draggable\");\n$RefreshReg$(_c8, \"AddImageModal\");\n$RefreshReg$(_c9, \"StickyNote\");\n$RefreshReg$(_c0, \"CanvasPage\");","map":{"version":3,"names":["React","useRef","useState","useEffect","useCallback","LuUndo2","LuRedo2","LuSettings2","LuDownload","LuStickyNote","LuImage","LuSquare","LuCircle","LuTriangle","LuArrowUpRight","LuEraser","LuHand","LuMousePointer2","LuPencil","LuType","LuShapes","LuPalette","LuGripHorizontal","LuChevronDown","LuSun","LuMoon","LuBrain","LuShare2","LuFileText","LuImageIcon","io","jsxDEV","_jsxDEV","TOOL_SELECT","TOOL_DRAW","TOOL_ERASE","TOOL_RECT","TOOL_ELLIPSE","TOOL_LINE","TOOL_TEXT","FONT_OPTIONS","label","value","COLORS_LIGHT","COLORS_DARK","useIsDarkMode","_s","isDark","setIsDark","document","documentElement","classList","contains","observer","MutationObserver","observe","attributes","attributeFilter","disconnect","tools","key","icon","width","height","fill","stroke","strokeWidth","children","d","fileName","_jsxFileName","lineNumber","columnNumber","x","y","rx","cx","cy","ry","x1","y1","x2","y2","fontSize","fontFamily","undoIcon","size","redoIcon","DarkModeToggleTop","_s2","dark","setDark","add","remove","onClick","className","title","color","_c","DownloadModal","open","onClose","onDownload","_c2","TopControlsBox","onUndo","onRedo","boardId","_s3","copied","setCopied","dropdownOpen","setDropdownOpen","showDownloadModal","setShowDownloadModal","iconColor","handleDropdownToggleDark","url","window","location","origin","pathname","handleCopy","navigator","clipboard","writeText","setTimeout","v","style","minWidth","_c3","LogoStandalone","_s4","padding","marginRight","flexShrink","fontWeight","letterSpacing","lineHeight","_c4","BottomToolbar","tool","setTool","iconSize","_c5","RightToolbar","eraserSize","setEraserSize","setColor","opacity","setOpacity","selectedStickyId","selectedTextId","stickyFont","textFont","onStickyColorChange","onStickyFontChange","onTextColorChange","onTextFontChange","elements","COLORS","isColorEnabled","getCurrentColor","note","stickyNotes","find","n","id","text","textBoxes","t","handleColorChange","newColor","map","c","background","disabled","Math","round","type","min","max","step","onChange","e","Number","target","f","_c6","isNearPoint","pt","threshold","hypot","Draggable","onDrag","props","_s5","dragging","setDragging","position","setPosition","handlePointerDown","stopPropagation","handlePointerMove","newX","clientX","newY","clientY","handlePointerUp","addEventListener","removeEventListener","left","top","cursor","transition","onPointerDown","_c7","AddImageModal","onAdd","_s6","tab","setTab","setUrl","file","setFile","gifs","setGifs","gifQuery","setGifQuery","loading","setLoading","fetch","encodeURIComponent","then","res","json","data","placeholder","src","accept","files","reader","FileReader","onload","ev","result","readAsDataURL","gif","images","fixed_width_small","alt","original","_c8","StickyNote","rotation","font","isEditing","isSelected","onEdit","onDelete","onResize","onRotate","editingRef","onSelectionChange","_s7","resizing","setResizing","rotating","setRotating","local","setLocal","noteRef","contentRef","selection","setSelection","handleDrag","info","l","point","handleResize","startX","startY","startW","startH","onMove","newW","newH","onUp","handleRotate","rect","current","getBoundingClientRect","centerX","centerY","dx","dy","angle","atan2","PI","handleSelection","sel","getSelection","rangeCount","anchorNode","getRangeAt","ref","transform","zIndex","boxShadow","userSelect","drag","dragMomentum","dragElastic","onDragStart","onDragEnd","borderBottom","contentEditable","suppressContentEditableWarning","minHeight","onBlur","onInput","currentTarget","innerHTML","onSelect","onKeyUp","onMouseUp","dangerouslySetInnerHTML","__html","onDoubleClick","_c9","SOCKET_SERVER_URL","CanvasPage","_s8","_elements$stickyNotes","_elements$textBoxes$f","_canvasRef$current2","_canvasRef$current3","urlId","hash","replace","randomId","random","toString","slice","setElements","savedState","localStorage","getItem","JSON","parse","lines","error","console","drawing","setDrawing","undoStack","setUndoStack","savedUndo","redoStack","setRedoStack","savedRedo","setItem","stringify","eraserPos","setEraserPos","eraserPreview","setEraserPreview","editingTextId","setEditingTextId","editingStickyId","setEditingStickyId","setSelectedStickyId","setSelectedTextId","canvasRef","showAddImageModal","setShowAddImageModal","pendingImagePos","setPendingImagePos","mousePos","setMousePos","socketRef","setStickyFont","editingStickyRef","editingStickySelection","setEditingStickySelection","editingTextRef","editingTextSelection","setEditingTextSelection","lastEraserPos","setLastEraserPos","pushToUndo","prev","eraseAt","filter","line","points","some","isInBox","img","tb","bx","by","bw","bh","handleMouseMove","_canvasRef$current","requestAnimationFrame","newLines","length","push","steps","ceil","i","ix","iy","handleCanvasPointerDown","Date","now","handleAddImage","handleUndo","prevUndo","prevRedo","prevElements","handleRedo","nextElements","handleKeyDown","ctrlKey","metaKey","preventDefault","shiftKey","canvas","ctx","getContext","clearRect","lineCap","lineJoin","forEach","save","strokeStyle","globalAlpha","undefined","lineWidth","beginPath","moveTo","lineTo","restore","handleToolbarToolSelect","selectedTool","innerWidth","innerHeight","socket","emit","on","applyStyleToSelection","styleType","focus","removeAllRanges","addRange","execCommand","handleTextSelection","applyStyleToTextSelection","handleDownload","format","tempCanvas","createElement","tempCtx","fillStyle","fillRect","fillText","imagePromises","Promise","resolve","image","Image","crossOrigin","drawImage","onerror","all","jsPDF","pdf","orientation","unit","addImage","toDataURL","link","download","href","click","alert","onMouseMove","newFont","onPointerMove","onPointerUp","onPointerLeave","newText","pos","borderRadius","pointerEvents","border","willChange","display","alignItems","justifyContent","_c0","$RefreshReg$"],"sources":["C:/Users/amaar/braindump/frontend/src/pages/CanvasPage.js"],"sourcesContent":["import React, { useRef, useState, useEffect, useCallback } from \"react\";\r\nimport { LuUndo2, LuRedo2, LuSettings2, LuDownload, LuStickyNote, LuImage, LuSquare, LuCircle, LuTriangle, LuArrowUpRight, LuEraser, LuHand, LuMousePointer2, LuPencil, LuType, LuShapes, LuPalette, LuGripHorizontal, LuChevronDown, LuSun, LuMoon, LuBrain, LuShare2, LuFileText, LuImage as LuImageIcon } from \"react-icons/lu\";\r\nimport io from \"socket.io-client\";\r\n\r\nconst TOOL_SELECT = \"select\";\r\nconst TOOL_DRAW = \"draw\";\r\nconst TOOL_ERASE = \"erase\";\r\nconst TOOL_RECT = \"rect\";\r\nconst TOOL_ELLIPSE = \"ellipse\";\r\nconst TOOL_LINE = \"line\";\r\nconst TOOL_TEXT = \"text\";\r\n\r\nconst FONT_OPTIONS = [\r\n  { label: 'Inter', value: 'Inter, sans-serif' },\r\n  { label: 'Comic Sans', value: 'Comic Sans MS, Comic Sans, cursive' },\r\n  { label: 'Serif', value: 'serif' },\r\n  { label: 'Mono', value: 'monospace' },\r\n  { label: 'Montserrat', value: 'Montserrat, sans-serif' },\r\n];\r\n\r\nconst COLORS_LIGHT = [\r\n  \"#000000\", \"#ffffff\", \"#e03131\", \"#1971c2\", \"#fab005\", \"#40c057\", \"#ae3ec9\", \"#fd7e14\"\r\n];\r\nconst COLORS_DARK = [\r\n  \"#ffffff\", \"#000000\", \"#fa5252\", \"#4dabf7\", \"#ffe066\", \"#69db7c\", \"#b197fc\", \"#ffa94d\"\r\n];\r\n\r\nfunction useIsDarkMode() {\r\n  const [isDark, setIsDark] = useState(() => document.documentElement.classList.contains(\"dark\"));\r\n  useEffect(() => {\r\n    const observer = new MutationObserver(() => {\r\n      setIsDark(document.documentElement.classList.contains(\"dark\"));\r\n    });\r\n    observer.observe(document.documentElement, { attributes: true, attributeFilter: [\"class\"] });\r\n    return () => observer.disconnect();\r\n  }, []);\r\n  return isDark;\r\n}\r\n\r\nconst tools = [\r\n  { key: TOOL_SELECT, label: \"Select\", icon: (\r\n    <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><path d=\"M3 3l14 7-7 3-3 7-4-17z\"/></svg>\r\n  ) },\r\n  { key: TOOL_DRAW, label: \"Draw\", icon: (\r\n    <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><path d=\"M4 15.5V19h3.5l10-10.1-3.5-3.4L4 15.5z\"/></svg>\r\n  ) },\r\n  { key: TOOL_ERASE, label: \"Eraser\", icon: (\r\n    <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><rect x=\"3\" y=\"14\" width=\"13\" height=\"3\" rx=\"1.5\"/><path d=\"M5 13l7-7a2 2 0 112.8 2.8l-7 7\"/></svg>\r\n  ) },\r\n  { key: TOOL_RECT, label: \"Rectangle\", icon: (\r\n    <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><rect x=\"4\" y=\"4\" width=\"12\" height=\"12\" rx=\"2\"/></svg>\r\n  ) },\r\n  { key: TOOL_ELLIPSE, label: \"Ellipse\", icon: (\r\n    <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><ellipse cx=\"10\" cy=\"10\" rx=\"7\" ry=\"5\"/></svg>\r\n  ) },\r\n  { key: TOOL_LINE, label: \"Line\", icon: (\r\n    <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><line x1=\"4\" y1=\"16\" x2=\"16\" y2=\"4\"/></svg>\r\n  ) },\r\n  { key: TOOL_TEXT, label: \"Text\", icon: (\r\n    <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><text x=\"4\" y=\"16\" fontSize=\"12\" fontFamily=\"sans-serif\">T</text></svg>\r\n  ) },\r\n];\r\n\r\nconst undoIcon = <LuUndo2 size={22} />;\r\nconst redoIcon = <LuRedo2 size={22} />;\r\n\r\n// Custom DarkModeToggle for top right\r\nfunction DarkModeToggleTop() {\r\n  const [dark, setDark] = useState(() => document.documentElement.classList.contains(\"dark\"));\r\n  useEffect(() => {\r\n    if (dark) {\r\n      document.documentElement.classList.add(\"dark\");\r\n    } else {\r\n      document.documentElement.classList.remove(\"dark\");\r\n    }\r\n  }, [dark]);\r\n  return (\r\n    <button\r\n      onClick={() => setDark((d) => !d)}\r\n      className=\"p-2 ml-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800\"\r\n      title={dark ? \"Switch to light mode\" : \"Switch to dark mode\"}\r\n    >\r\n      {dark ? <LuSun size={22} color=\"#fff\" /> : <LuMoon size={22} color=\"#222\" />}\r\n    </button>\r\n  );\r\n}\r\n\r\n// Download Modal Component\r\nfunction DownloadModal({ open, onClose, onDownload, isDark }) {\r\n  if (!open) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/30 dark:bg-black/60\">\r\n      <div className={`bg-white dark:bg-zinc-900 rounded-xl shadow-xl p-6 w-[370px] max-w-full relative border border-gray-200 dark:border-zinc-700`}>\r\n        <button onClick={onClose} className=\"absolute top-3 right-3 text-2xl text-gray-400 hover:text-gray-700 dark:hover:text-gray-200\">&times;</button>\r\n        <h2 className=\"text-xl font-semibold mb-4 text-gray-900 dark:text-gray-100\">Download Options</h2>\r\n        <div className=\"space-y-4\">\r\n          <button\r\n            onClick={() => onDownload('pdf')}\r\n            className=\"w-full flex items-center gap-3 px-4 py-3 rounded-lg border border-gray-200 dark:border-zinc-700 hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors\"\r\n          >\r\n            <LuFileText size={24} className=\"text-blue-500\" />\r\n            <div className=\"text-left\">\r\n              <div className=\"font-medium text-gray-900 dark:text-gray-100\">Download as PDF</div>\r\n              <div className=\"text-sm text-gray-500 dark:text-gray-400\">High quality vector format</div>\r\n            </div>\r\n          </button>\r\n          <button\r\n            onClick={() => onDownload('jpg')}\r\n            className=\"w-full flex items-center gap-3 px-4 py-3 rounded-lg border border-gray-200 dark:border-zinc-700 hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors\"\r\n          >\r\n            <LuImageIcon size={24} className=\"text-green-500\" />\r\n            <div className=\"text-left\">\r\n              <div className=\"font-medium text-gray-900 dark:text-gray-100\">Download as JPG</div>\r\n              <div className=\"text-sm text-gray-500 dark:text-gray-400\">Image format</div>\r\n            </div>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction TopControlsBox({ onUndo, onRedo, boardId, onDownload }) {\r\n  // Detect dark mode for icon color\r\n  const [isDark, setIsDark] = useState(() => document.documentElement.classList.contains(\"dark\"));\r\n  const [copied, setCopied] = useState(false);\r\n  const [dropdownOpen, setDropdownOpen] = useState(false);\r\n  const [showDownloadModal, setShowDownloadModal] = useState(false);\r\n  useEffect(() => {\r\n    const observer = new MutationObserver(() => {\r\n      setIsDark(document.documentElement.classList.contains(\"dark\"));\r\n    });\r\n    observer.observe(document.documentElement, { attributes: true, attributeFilter: [\"class\"] });\r\n    return () => observer.disconnect();\r\n  }, []);\r\n  const iconColor = isDark ? \"#fff\" : \"#222\";\r\n  // Toggle dark mode\r\n  const handleDropdownToggleDark = () => {\r\n    if (isDark) {\r\n      document.documentElement.classList.remove(\"dark\");\r\n    } else {\r\n      document.documentElement.classList.add(\"dark\");\r\n    }\r\n    setIsDark(!isDark);\r\n    setDropdownOpen(false);\r\n  };\r\n  // Share logic\r\n  const url = `${window.location.origin}${window.location.pathname}#${boardId}`;\r\n  const handleCopy = () => {\r\n    navigator.clipboard.writeText(url);\r\n    setCopied(true);\r\n    setTimeout(() => setCopied(false), 1500);\r\n  };\r\n  return (\r\n    <div className=\"fixed top-4 right-6 z-50 flex items-center gap-2 bg-white/90 dark:bg-zinc-900/90 border border-gray-200 dark:border-zinc-700 rounded-xl shadow-lg px-3 py-2\">\r\n      <button title=\"Undo (Ctrl+Z)\" className=\"p-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800\" onClick={onUndo}><LuUndo2 size={22} color={iconColor} /></button>\r\n      <button title=\"Redo (Ctrl+Y)\" className=\"p-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800\" onClick={onRedo}><LuRedo2 size={22} color={iconColor} /></button>\r\n      <button title=\"Export\" className=\"p-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800\" onClick={() => setShowDownloadModal(true)}><LuDownload size={22} color={iconColor} /></button>\r\n      {/* Preferences with dropdown */}\r\n      <div className=\"relative z-[9999]\">\r\n        <button\r\n          title=\"Preferences\"\r\n          className=\"p-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800\"\r\n          onClick={() => setDropdownOpen((v) => !v)}\r\n        >\r\n          <LuSettings2 size={22} color={iconColor} />\r\n        </button>\r\n        {dropdownOpen && (\r\n          <div className=\"absolute right-0 mt-2 w-52 border border-zinc-200 dark:border-zinc-800 rounded-lg shadow-lg py-2 z-[9999] text-sm bg-white/90 dark:bg-zinc-900/90 backdrop-blur-sm pointer-events-auto\">\r\n            <div className=\"flex items-center justify-between px-4 py-2 gap-3\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <LuMoon size={18} className=\"text-zinc-500 dark:text-zinc-200\" />\r\n                <span className=\"font-medium\">{isDark ? 'Light Mode' : 'Dark Mode'}</span>\r\n              </div>\r\n              <button\r\n                aria-label=\"Toggle dark mode\"\r\n                onClick={handleDropdownToggleDark}\r\n                className={`relative w-10 h-6 rounded-full transition-colors duration-200 ${isDark ? 'bg-teal-500' : 'bg-zinc-300'}`}\r\n                style={{ minWidth: 40 }}\r\n              >\r\n                <span\r\n                  className={`absolute top-1 left-1 w-4 h-4 rounded-full bg-white shadow transition-transform duration-200 ${isDark ? 'translate-x-4' : ''}`}\r\n                />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n      {/* Share icon button */}\r\n      <div className=\"relative\">\r\n        <button\r\n          title=\"Copy board link\"\r\n          className=\"p-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800\"\r\n          onClick={handleCopy}\r\n        >\r\n          <LuShare2 size={22} color={iconColor} />\r\n        </button>\r\n        {copied && (\r\n          <div className=\"absolute right-0 mt-2 px-2 py-1 bg-zinc-900 text-white text-xs rounded shadow\">Link copied!</div>\r\n        )}\r\n      </div>\r\n      <DownloadModal \r\n        open={showDownloadModal} \r\n        onClose={() => setShowDownloadModal(false)} \r\n        onDownload={onDownload}\r\n        isDark={isDark}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction LogoStandalone() {\r\n  // Use LuBrain icon for a literal brain representation\r\n  const [isDark, setIsDark] = useState(() => document.documentElement.classList.contains(\"dark\"));\r\n  useEffect(() => {\r\n    const observer = new MutationObserver(() => {\r\n      setIsDark(document.documentElement.classList.contains(\"dark\"));\r\n    });\r\n    observer.observe(document.documentElement, { attributes: true, attributeFilter: [\"class\"] });\r\n    return () => observer.disconnect();\r\n  }, []);\r\n  const iconColor = isDark ? \"#fff\" : \"#222\";\r\n  return (\r\n    <div className=\"fixed top-4 left-6 z-50 flex items-center select-none\" style={{height: '3.5rem', padding: '0.25rem 0.5rem'}}>\r\n      <LuBrain size={48} color={iconColor} style={{marginRight: 16, flexShrink: 0}} />\r\n      <span style={{ fontFamily: 'Montserrat, Inter, sans-serif', fontWeight: 600, fontSize: '2.1rem', letterSpacing: '0.01em', lineHeight: 1, color: iconColor }}>braindump</span>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Bottom Toolbar\r\nfunction BottomToolbar({ tool, setTool }) {\r\n  const iconSize = 24;\r\n  return (\r\n    <div className=\"fixed bottom-4 left-1/2 -translate-x-1/2 z-50 flex items-center bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-700 rounded-xl shadow-lg px-3 py-2 gap-1\" style={{ minWidth: 320 }}>\r\n      <button title=\"Select\" className={`p-2 rounded-lg ${tool === 'select' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`} onClick={() => setTool('select')}><LuMousePointer2 size={iconSize} /></button>\r\n      <button title=\"Hand\" className={`p-2 rounded-lg ${tool === 'hand' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`} onClick={() => setTool('hand')}><LuHand size={iconSize} /></button>\r\n      <button title=\"Draw\" className={`p-2 rounded-lg ${tool === 'draw' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`} onClick={() => setTool('draw')}><LuPencil size={iconSize} /></button>\r\n      <button title=\"Eraser\" className={`p-2 rounded-lg ${tool === 'eraser' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`} onClick={() => setTool('eraser')}><LuEraser size={iconSize} /></button>\r\n      <div className=\"w-px h-6 bg-gray-200 dark:bg-zinc-700 mx-1\"></div>\r\n      <button title=\"Sticky Note\" className={`p-2 rounded-lg ${tool === 'sticky' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`} onClick={() => setTool('sticky')}><LuStickyNote size={iconSize} /></button>\r\n      <button title=\"Image\" className={`p-2 rounded-lg ${tool === 'image' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`} onClick={() => setTool('image')}><LuImage size={iconSize} /></button>\r\n      <button title=\"Text\" className={`p-2 rounded-lg ${tool === 'text' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`} onClick={() => setTool('text')}><LuType size={iconSize} /></button>\r\n      <button title=\"Shapes\" className={`p-2 rounded-lg ${tool === 'shapes' ? 'bg-gray-200 dark:bg-zinc-700' : 'hover:bg-gray-100 dark:hover:bg-zinc-800'}`} onClick={() => setTool('shapes')}><LuShapes size={iconSize} /></button>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Right Toolbar\r\nfunction RightToolbar({ tool, eraserSize, setEraserSize, color, setColor, opacity, setOpacity, selectedStickyId, selectedTextId, stickyFont, textFont, onStickyColorChange, onStickyFontChange, onTextColorChange, onTextFontChange, elements }) {\r\n  const COLORS = [\"#fff\", \"#000\", \"#e03131\", \"#1971c2\", \"#fab005\", \"#40c057\", \"#ae3ec9\", \"#fd7e14\"];\r\n  \r\n  // Determine if color palette should be enabled\r\n  const isColorEnabled = tool === 'draw' || selectedStickyId || selectedTextId;\r\n  \r\n  // Get the current color based on selection\r\n  const getCurrentColor = () => {\r\n    if (tool === 'draw') return color;\r\n    if (selectedStickyId) {\r\n      const note = elements.stickyNotes.find(n => n.id === selectedStickyId);\r\n      return note?.color || \"#fff\";\r\n    }\r\n    if (selectedTextId) {\r\n      const text = elements.textBoxes.find(t => t.id === selectedTextId);\r\n      return text?.color || \"#222\";\r\n    }\r\n    return color;\r\n  };\r\n\r\n  // Handle color change based on current selection\r\n  const handleColorChange = (newColor) => {\r\n    if (tool === 'draw') {\r\n      setColor(newColor);\r\n    } else if (selectedStickyId) {\r\n      onStickyColorChange(newColor);\r\n    } else if (selectedTextId) {\r\n      onTextColorChange(newColor);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed top-20 right-6 z-40 flex flex-col items-center gap-5 bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-700 rounded-xl shadow-lg px-4 py-5 min-w-[180px]\">\r\n      {/* Unified color palette */}\r\n      <div className=\"w-full\">\r\n        <div className=\"text-xs text-gray-500 dark:text-gray-400 mb-1 font-medium\">\r\n          {tool === 'draw' ? 'Pen Color' : selectedStickyId ? 'Sticky Color' : selectedTextId ? 'Text Color' : 'Color'}\r\n        </div>\r\n        <div className=\"flex flex-wrap gap-2 mb-2\">\r\n          {COLORS.map((c) => (\r\n            <button\r\n              key={c}\r\n              className={`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all duration-100 ${isColorEnabled && getCurrentColor() === c ? 'border-zinc-900 dark:border-white scale-110 shadow' : 'border-gray-300 dark:border-zinc-700'} ${!isColorEnabled ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n              style={{ background: c }}\r\n              onClick={() => isColorEnabled && handleColorChange(c)}\r\n              aria-label={`Select color ${c}`}\r\n              disabled={!isColorEnabled}\r\n            >\r\n              {isColorEnabled && getCurrentColor() === c && <span className=\"w-2 h-2 rounded-full bg-white border border-zinc-900 dark:border-white\" />}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n      {/* Opacity slider */}\r\n      <div className=\"w-full\">\r\n        <div className=\"flex items-center justify-between mb-1\">\r\n          <span className=\"text-xs text-gray-500 dark:text-gray-400 font-medium\">Opacity</span>\r\n          <span className=\"text-xs text-gray-500 dark:text-gray-400\">{Math.round(opacity * 100)}%</span>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <LuGripHorizontal />\r\n          <input type=\"range\" min=\"0.1\" max=\"1\" step=\"0.01\" value={opacity} onChange={e => setOpacity(Number(e.target.value))} className=\"w-full\" />\r\n        </div>\r\n      </div>\r\n      {/* Font dropdown for sticky notes */}\r\n      {selectedStickyId && (\r\n        <div className=\"w-full\">\r\n          <div className=\"text-xs text-gray-500 dark:text-gray-400 mb-1 font-medium\">Sticky Font</div>\r\n          <select\r\n            className=\"w-full px-2 py-1 rounded border border-gray-300 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-sm disabled:opacity-50\"\r\n            value={stickyFont || ''}\r\n            onChange={e => onStickyFontChange(e.target.value)}\r\n          >\r\n            <option value=\"\" disabled>Select font</option>\r\n            {FONT_OPTIONS.map(f => <option key={f.value} value={f.value}>{f.label}</option>)}\r\n          </select>\r\n        </div>\r\n      )}\r\n      {/* Font dropdown for text boxes */}\r\n      {selectedTextId && (\r\n        <div className=\"w-full\">\r\n          <div className=\"text-xs text-gray-500 dark:text-gray-400 mb-1 font-medium\">Text Font</div>\r\n          <select\r\n            className=\"w-full px-2 py-1 rounded border border-gray-300 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-sm disabled:opacity-50\"\r\n            value={textFont || ''}\r\n            onChange={e => onTextFontChange(e.target.value)}\r\n          >\r\n            <option value=\"\" disabled>Select font</option>\r\n            {FONT_OPTIONS.map(f => <option key={f.value} value={f.value}>{f.label}</option>)}\r\n          </select>\r\n        </div>\r\n      )}\r\n      {/* Eraser size control - only show when eraser tool is selected */}\r\n      {tool === 'eraser' && (\r\n        <div className=\"w-full\">\r\n          <div className=\"flex items-center justify-between mb-1\">\r\n            <span className=\"text-xs text-gray-500 dark:text-gray-400 font-medium\">Eraser Size</span>\r\n            <span className=\"text-xs text-gray-500 dark:text-gray-400\">{eraserSize}px</span>\r\n          </div>\r\n          <input\r\n            type=\"range\"\r\n            min=\"8\"\r\n            max=\"64\"\r\n            value={eraserSize}\r\n            onChange={(e) => setEraserSize(Number(e.target.value))}\r\n            className=\"w-full\"\r\n          />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction isNearPoint(x, y, pt, threshold = 8) {\r\n  return Math.hypot(x - pt.x, y - pt.y) < threshold;\r\n}\r\n\r\nfunction Draggable({ x, y, children, onDrag, style, ...props }) {\r\n  const [dragging, setDragging] = useState(false);\r\n  const [position, setPosition] = useState({ x, y });\r\n\r\n  const handlePointerDown = (e) => {\r\n    e.stopPropagation();\r\n    setDragging(true);\r\n  };\r\n\r\n  const handlePointerMove = (e) => {\r\n    if (dragging) {\r\n      const newX = e.clientX;\r\n      const newY = e.clientY;\r\n      setPosition({ x: newX, y: newY });\r\n      onDrag && onDrag({ x: newX, y: newY });\r\n    }\r\n  };\r\n\r\n  const handlePointerUp = () => setDragging(false);\r\n\r\n  useEffect(() => {\r\n    if (dragging) {\r\n      window.addEventListener('pointermove', handlePointerMove);\r\n      window.addEventListener('pointerup', handlePointerUp);\r\n    }\r\n    return () => {\r\n      window.removeEventListener('pointermove', handlePointerMove);\r\n      window.removeEventListener('pointerup', handlePointerUp);\r\n    };\r\n  }, [dragging]);\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'absolute',\r\n        left: position.x,\r\n        top: position.y,\r\n        cursor: dragging ? 'grabbing' : 'grab',\r\n        transition: dragging ? 'none' : 'all 0.15s ease-out',\r\n        ...style\r\n      }}\r\n      onPointerDown={handlePointerDown}\r\n      {...props}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\n// AddImageModal component\r\nfunction AddImageModal({ open, onClose, onAdd, position, isDark }) {\r\n  const [tab, setTab] = useState('url');\r\n  const [url, setUrl] = useState('');\r\n  const [file, setFile] = useState(null);\r\n  const [gifs, setGifs] = useState([]);\r\n  const [gifQuery, setGifQuery] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (tab === 'gif' && gifQuery) {\r\n      setLoading(true);\r\n      fetch(`https://api.giphy.com/v1/gifs/search?api_key=dc6zaTOxFJmzC&q=${encodeURIComponent(gifQuery)}&limit=12`)\r\n        .then(res => res.json())\r\n        .then(data => {\r\n          setGifs(data.data);\r\n          setLoading(false);\r\n        });\r\n    }\r\n  }, [tab, gifQuery]);\r\n\r\n  if (!open) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/30 dark:bg-black/60\">\r\n      <div className={`bg-white dark:bg-zinc-900 rounded-xl shadow-xl p-6 w-[370px] max-w-full relative border border-gray-200 dark:border-zinc-700`}>\r\n        <button onClick={onClose} className=\"absolute top-3 right-3 text-2xl text-gray-400 hover:text-gray-700 dark:hover:text-gray-200\">&times;</button>\r\n        <div className=\"mb-4 flex gap-2\">\r\n          <button onClick={() => setTab('url')} className={`px-4 py-1.5 rounded-t-lg border ${tab==='url' ? 'bg-gray-100 dark:bg-zinc-800 border-gray-300 dark:border-zinc-700 font-semibold' : 'bg-transparent border-transparent'}`}>URL</button>\r\n          <button onClick={() => setTab('upload')} className={`px-4 py-1.5 rounded-t-lg border ${tab==='upload' ? 'bg-gray-100 dark:bg-zinc-800 border-gray-300 dark:border-zinc-700 font-semibold' : 'bg-transparent border-transparent'}`}>Upload</button>\r\n          <button onClick={() => setTab('gif')} className={`px-4 py-1.5 rounded-t-lg border ${tab==='gif' ? 'bg-gray-100 dark:bg-zinc-800 border-gray-300 dark:border-zinc-700 font-semibold' : 'bg-transparent border-transparent'}`}>GIF</button>\r\n        </div>\r\n        {tab === 'url' && (\r\n          <div>\r\n            <label className=\"block text-sm mb-2 font-medium text-gray-700 dark:text-gray-200\">Image URL</label>\r\n            <input type=\"text\" value={url} onChange={e => setUrl(e.target.value)} placeholder=\"https://example.com/image.jpg\" className=\"w-full px-3 py-2 rounded border border-gray-300 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-gray-100 mb-4\" />\r\n            <button className=\"w-full py-2 rounded bg-gray-300 dark:bg-zinc-700 text-gray-700 dark:text-gray-200 font-semibold disabled:opacity-60\" disabled={!url} onClick={() => { onAdd({ type: 'url', src: url, position }); onClose(); }}>Add Image</button>\r\n          </div>\r\n        )}\r\n        {tab === 'upload' && (\r\n          <div>\r\n            <label className=\"block text-sm mb-2 font-medium text-gray-700 dark:text-gray-200\">Upload Image</label>\r\n            <input type=\"file\" accept=\"image/*\" onChange={e => setFile(e.target.files[0])} className=\"mb-4\" />\r\n            <button className=\"w-full py-2 rounded bg-gray-300 dark:bg-zinc-700 text-gray-700 dark:text-gray-200 font-semibold disabled:opacity-60\" disabled={!file} onClick={() => {\r\n              const reader = new FileReader();\r\n              reader.onload = (ev) => { onAdd({ type: 'upload', src: ev.target.result, position }); onClose(); };\r\n              reader.readAsDataURL(file);\r\n            }}>Add Image</button>\r\n          </div>\r\n        )}\r\n        {tab === 'gif' && (\r\n          <div>\r\n            <label className=\"block text-sm mb-2 font-medium text-gray-700 dark:text-gray-200\">Search GIFs</label>\r\n            <input type=\"text\" value={gifQuery} onChange={e => setGifQuery(e.target.value)} placeholder=\"funny cat\" className=\"w-full px-3 py-2 rounded border border-gray-300 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-gray-100 mb-2\" />\r\n            <div className=\"h-32 overflow-y-auto grid grid-cols-3 gap-2 mb-2\">\r\n              {loading ? <div className=\"col-span-3 text-center text-gray-400\">Loading...</div> :\r\n                gifs.map(gif => (\r\n                  <img key={gif.id} src={gif.images.fixed_width_small.url} alt={gif.title} className=\"rounded cursor-pointer hover:scale-105 transition\" onClick={() => { onAdd({ type: 'gif', src: gif.images.original.url, position }); onClose(); }} />\r\n                ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction StickyNote({\r\n  id, x, y, width, height, rotation, color, font, text, isEditing, isSelected, onClick, onChange, onEdit, onDelete, onDrag, onResize, onRotate, editingRef, onSelectionChange\r\n}) {\r\n  const [dragging, setDragging] = useState(false);\r\n  const [resizing, setResizing] = useState(false);\r\n  const [rotating, setRotating] = useState(false);\r\n  const [local, setLocal] = useState({ x, y, width, height, rotation });\r\n  const noteRef = useRef();\r\n  const contentRef = useRef();\r\n\r\n  // Track selection for rich text\r\n  const [selection, setSelection] = useState(null);\r\n\r\n  // Drag logic\r\n  function handleDrag(e, info) {\r\n    setLocal(l => ({ ...l, x: info.point.x, y: info.point.y }));\r\n    if (onDrag) onDrag({ x: info.point.x, y: info.point.y });\r\n  }\r\n\r\n  // Resize logic\r\n  function handleResize(e) {\r\n    e.stopPropagation();\r\n    setResizing(true);\r\n    const startX = e.clientX;\r\n    const startY = e.clientY;\r\n    const startW = local.width;\r\n    const startH = local.height;\r\n    function onMove(ev) {\r\n      const newW = Math.max(80, startW + (ev.clientX - startX));\r\n      const newH = Math.max(40, startH + (ev.clientY - startY));\r\n      setLocal(l => ({ ...l, width: newW, height: newH }));\r\n      if (onResize) onResize({ width: newW, height: newH });\r\n    }\r\n    function onUp() {\r\n      setResizing(false);\r\n      window.removeEventListener('pointermove', onMove);\r\n      window.removeEventListener('pointerup', onUp);\r\n    }\r\n    window.addEventListener('pointermove', onMove);\r\n    window.addEventListener('pointerup', onUp);\r\n  }\r\n\r\n  // Rotate logic\r\n  function handleRotate(e) {\r\n    e.stopPropagation();\r\n    setRotating(true);\r\n    const rect = noteRef.current.getBoundingClientRect();\r\n    const centerX = rect.left + rect.width / 2;\r\n    const centerY = rect.top + rect.height / 2;\r\n    function onMove(ev) {\r\n      const dx = ev.clientX - centerX;\r\n      const dy = ev.clientY - centerY;\r\n      const angle = Math.atan2(dy, dx) * 180 / Math.PI;\r\n      setLocal(l => ({ ...l, rotation: angle }));\r\n      if (onRotate) onRotate({ rotation: angle });\r\n    }\r\n    function onUp() {\r\n      setRotating(false);\r\n      window.removeEventListener('pointermove', onMove);\r\n      window.removeEventListener('pointerup', onUp);\r\n    }\r\n    window.addEventListener('pointermove', onMove);\r\n    window.addEventListener('pointerup', onUp);\r\n  }\r\n\r\n  // Handle selection change\r\n  function handleSelection() {\r\n    const sel = window.getSelection();\r\n    if (sel && sel.rangeCount > 0 && contentRef.current && contentRef.current.contains(sel.anchorNode)) {\r\n      setSelection(sel.getRangeAt(0));\r\n      if (onSelectionChange) onSelectionChange(sel.getRangeAt(0));\r\n    } else {\r\n      setSelection(null);\r\n      if (onSelectionChange) onSelectionChange(null);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (editingRef && isEditing) {\r\n      editingRef.current = contentRef.current;\r\n    }\r\n  }, [editingRef, isEditing]);\r\n\r\n  return (\r\n    <div\r\n      ref={noteRef}\r\n      className={`absolute shadow-lg rounded-lg ${isSelected ? 'ring-2 ring-blue-500 ring-offset-2' : ''}`}\r\n      style={{\r\n        left: local.x,\r\n        top: local.y,\r\n        width: local.width,\r\n        height: local.height,\r\n        background: color,\r\n        fontFamily: font,\r\n        transform: `rotate(${local.rotation || 0}deg)`,\r\n        transition: dragging || resizing || rotating ? 'none' : 'box-shadow 0.2s, transform 0.2s',\r\n        zIndex: dragging ? 100 : 10,\r\n        boxShadow: dragging ? '0 8px 32px 0 rgba(0,0,0,0.18)' : '0 2px 8px 0 rgba(0,0,0,0.10)',\r\n        userSelect: isEditing ? 'text' : 'none',\r\n      }}\r\n      drag\r\n      dragMomentum={false}\r\n      dragElastic={0.18}\r\n      onDragStart={() => setDragging(true)}\r\n      onDragEnd={(e, info) => { setDragging(false); if (onDrag) onDrag({ x: info.point.x, y: info.point.y }); }}\r\n      onDrag={handleDrag}\r\n      onClick={onClick}\r\n    >\r\n      {/* Toolbar */}\r\n      <div className=\"flex items-center gap-1 px-2 py-1 bg-white/60 dark:bg-zinc-900/60 rounded-t-lg\" style={{ cursor: 'move', borderBottom: '1px solid #eee' }}>\r\n        <button onClick={onEdit} className=\"ml-auto text-xs px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-zinc-800\">✏️</button>\r\n        <button onClick={onDelete} className=\"text-xs px-1 py-0.5 rounded hover:bg-red-100 dark:hover:bg-red-900\">🗑️</button>\r\n        <button onPointerDown={handleRotate} className=\"text-xs px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-zinc-800 cursor-alias\">⟳</button>\r\n      </div>\r\n      {/* Content */}\r\n      {isEditing ? (\r\n        <div\r\n          ref={contentRef}\r\n          contentEditable\r\n          suppressContentEditableWarning\r\n          className=\"w-full h-full bg-transparent resize-none outline-none p-2 text-base rounded-b-lg\"\r\n          style={{ fontFamily: font, background: 'transparent', minHeight: 40, minWidth: 80 }}\r\n          onBlur={onEdit}\r\n          onInput={e => onChange && onChange(e.currentTarget.innerHTML)}\r\n          onSelect={handleSelection}\r\n          onKeyUp={handleSelection}\r\n          onMouseUp={handleSelection}\r\n          dangerouslySetInnerHTML={{ __html: text }}\r\n        />\r\n      ) : (\r\n        <div\r\n          className=\"w-full h-full p-2 text-base rounded-b-lg cursor-pointer\"\r\n          style={{ fontFamily: font, background: 'transparent', minHeight: 40, minWidth: 80 }}\r\n          onDoubleClick={onEdit}\r\n          dangerouslySetInnerHTML={{ __html: text }}\r\n        />\r\n      )}\r\n      {/* Resize handle */}\r\n      <div\r\n        onPointerDown={handleResize}\r\n        className=\"absolute right-1.5 bottom-1.5 w-3 h-3 bg-white dark:bg-zinc-800 border border-gray-300 dark:border-zinc-700 rounded cursor-se-resize\"\r\n        style={{ zIndex: 20 }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nconst SOCKET_SERVER_URL = \"http://localhost:4000\"; // Change if deploying\r\n\r\nexport default function CanvasPage() {\r\n  // Initialize boardId first\r\n  const [boardId] = useState(() => {\r\n    // Use URL param or random for now\r\n    const urlId = window.location.hash.replace('#', '');\r\n    if (urlId) return urlId;\r\n    const randomId = Math.random().toString(36).slice(2, 10);\r\n    window.location.hash = randomId;\r\n    return randomId;\r\n  });\r\n\r\n  // Unified state for all elements\r\n  const [elements, setElements] = useState(() => {\r\n    try {\r\n      // Load saved state from localStorage on initial render\r\n      const savedState = localStorage.getItem(`canvas-state-${boardId}`);\r\n      return savedState ? JSON.parse(savedState) : {\r\n        lines: [],\r\n        stickyNotes: [],\r\n        images: [],\r\n        textBoxes: [],\r\n      };\r\n    } catch (error) {\r\n      console.error('Error loading saved state:', error);\r\n      return {\r\n        lines: [],\r\n        stickyNotes: [],\r\n        images: [],\r\n        textBoxes: [],\r\n      };\r\n    }\r\n  });\r\n\r\n  const [drawing, setDrawing] = useState(false);\r\n  // Initialize undo/redo stacks from localStorage\r\n  const [undoStack, setUndoStack] = useState(() => {\r\n    try {\r\n      const savedUndo = localStorage.getItem(`undo-stack-${boardId}`);\r\n      return savedUndo ? JSON.parse(savedUndo) : [];\r\n    } catch (error) {\r\n      console.error('Error loading undo stack:', error);\r\n      return [];\r\n    }\r\n  });\r\n  const [redoStack, setRedoStack] = useState(() => {\r\n    try {\r\n      const savedRedo = localStorage.getItem(`redo-stack-${boardId}`);\r\n      return savedRedo ? JSON.parse(savedRedo) : [];\r\n    } catch (error) {\r\n      console.error('Error loading redo stack:', error);\r\n      return [];\r\n    }\r\n  });\r\n\r\n  // Save undo/redo stacks to localStorage whenever they change\r\n  useEffect(() => {\r\n    try {\r\n      localStorage.setItem(`undo-stack-${boardId}`, JSON.stringify(undoStack));\r\n    } catch (error) {\r\n      console.error('Error saving undo stack:', error);\r\n    }\r\n  }, [undoStack, boardId]);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      localStorage.setItem(`redo-stack-${boardId}`, JSON.stringify(redoStack));\r\n    } catch (error) {\r\n      console.error('Error saving redo stack:', error);\r\n    }\r\n  }, [redoStack, boardId]);\r\n\r\n  const [eraserSize, setEraserSize] = useState(16);\r\n  const [eraserPos, setEraserPos] = useState(null);\r\n  const [eraserPreview, setEraserPreview] = useState(false);\r\n  const [editingTextId, setEditingTextId] = useState(null);\r\n  const [editingStickyId, setEditingStickyId] = useState(null);\r\n  const [selectedStickyId, setSelectedStickyId] = useState(null);\r\n  const [selectedTextId, setSelectedTextId] = useState(null);\r\n  const [tool, setTool] = useState('draw');\r\n  const [color, setColor] = useState(\"#222\");\r\n  const [opacity, setOpacity] = useState(1);\r\n  const canvasRef = useRef(null);\r\n  const isDark = useIsDarkMode();\r\n  const [showAddImageModal, setShowAddImageModal] = useState(false);\r\n  const [pendingImagePos, setPendingImagePos] = useState(null);\r\n  const [mousePos, setMousePos] = useState({ x: 0, y: 0 });\r\n  const socketRef = useRef(null);\r\n  const [stickyFont, setStickyFont] = useState('Inter, sans-serif');\r\n  const editingStickyRef = useRef(null);\r\n  const [editingStickySelection, setEditingStickySelection] = useState(null);\r\n  const editingTextRef = useRef(null);\r\n  const [editingTextSelection, setEditingTextSelection] = useState(null);\r\n  const [lastEraserPos, setLastEraserPos] = useState(null);\r\n  const [showDownloadModal, setShowDownloadModal] = useState(false);\r\n\r\n  // Save state to localStorage whenever elements change\r\n  useEffect(() => {\r\n    try {\r\n      localStorage.setItem(`canvas-state-${boardId}`, JSON.stringify(elements));\r\n    } catch (error) {\r\n      console.error('Error saving state:', error);\r\n    }\r\n  }, [elements, boardId]);\r\n\r\n  // Helper: push to undo stack\r\n  const pushToUndo = (current) => {\r\n    setUndoStack((prev) => [...prev, current]);\r\n    setRedoStack([]);\r\n  };\r\n\r\n  // Erase logic for all elements\r\n  function eraseAt(x, y) {\r\n    setElements((prev) => {\r\n      // Erase lines\r\n      const lines = prev.lines.filter(line => !line.points.some(pt => \r\n        Math.hypot(x - pt.x, y - pt.y) < eraserSize / 2\r\n      ));\r\n      // Erase sticky notes\r\n      const stickyNotes = prev.stickyNotes.filter(note => !isInBox(x, y, note.x, note.y, 120, 80));\r\n      // Erase images\r\n      const images = prev.images.filter(img => !isInBox(x, y, img.x, img.y, img.width, img.height));\r\n      // Erase text boxes\r\n      const textBoxes = prev.textBoxes.filter(tb => !isInBox(x, y, tb.x, tb.y, 120, 40));\r\n      return { lines, stickyNotes, images, textBoxes };\r\n    });\r\n  }\r\n  function isInBox(x, y, bx, by, bw, bh) {\r\n    return x >= bx && x <= bx + bw && y >= by && y <= by + bh;\r\n  }\r\n\r\n  // Add mouse move handler with throttling\r\n  const handleMouseMove = (e) => {\r\n    const rect = canvasRef.current?.getBoundingClientRect();\r\n    if (rect) {\r\n      const x = e.clientX - rect.left;\r\n      const y = e.clientY - rect.top;\r\n      requestAnimationFrame(() => {\r\n        setMousePos({ x, y });\r\n        if (tool === 'eraser') {\r\n          setEraserPos({ x, y });\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  // Update pointer move handler with throttling\r\n  const handlePointerMove = (e) => {\r\n    const rect = canvasRef.current.getBoundingClientRect();\r\n    const x = e.clientX - rect.left;\r\n    const y = e.clientY - rect.top;\r\n\r\n    requestAnimationFrame(() => {\r\n      setMousePos({ x, y });\r\n      if (tool === 'eraser') {\r\n        setEraserPos({ x, y });\r\n      }\r\n    });\r\n\r\n    if (!drawing) return;\r\n    if (tool === 'draw') {\r\n      setElements((prev) => {\r\n        const newLines = [...prev.lines];\r\n        newLines[newLines.length - 1].points.push({ x, y });\r\n        return { ...prev, lines: newLines };\r\n      });\r\n    } else if (tool === 'eraser') {\r\n      // Interpolate between last and current position for smooth erasing\r\n      if (lastEraserPos) {\r\n        const steps = Math.ceil(Math.hypot(x - lastEraserPos.x, y - lastEraserPos.y) / (eraserSize / 2));\r\n        for (let i = 1; i <= steps; i++) {\r\n          const t = i / steps;\r\n          const ix = lastEraserPos.x + (x - lastEraserPos.x) * t;\r\n          const iy = lastEraserPos.y + (y - lastEraserPos.y) * t;\r\n          eraseAt(ix, iy);\r\n        }\r\n      } else {\r\n        eraseAt(x, y);\r\n      }\r\n      setLastEraserPos({ x, y });\r\n    }\r\n  };\r\n\r\n  const handlePointerDown = (e) => {\r\n    const rect = canvasRef.current.getBoundingClientRect();\r\n    const x = e.clientX - rect.left;\r\n    const y = e.clientY - rect.top;\r\n    if (tool === 'draw') {\r\n      pushToUndo(elements);\r\n      setElements((prev) => ({\r\n        ...prev,\r\n        lines: [...prev.lines, { points: [{ x, y }], color, opacity }],\r\n      }));\r\n      setDrawing(true);\r\n    } else if (tool === 'eraser') {\r\n      pushToUndo(elements);\r\n      eraseAt(x, y);\r\n      setDrawing(true);\r\n      setEraserPos({ x, y });\r\n      setLastEraserPos({ x, y });\r\n      setEraserPreview(true);\r\n    }\r\n  };\r\n\r\n  const handlePointerUp = () => {\r\n    setDrawing(false);\r\n    setEraserPos(null);\r\n    setLastEraserPos(null);\r\n    setEraserPreview(false);\r\n  };\r\n\r\n  // Add sticky note, image, or text box\r\n  const handleCanvasPointerDown = (e) => {\r\n    const rect = canvasRef.current.getBoundingClientRect();\r\n    const x = e.clientX - rect.left;\r\n    const y = e.clientY - rect.top;\r\n    if (tool === 'sticky') {\r\n      pushToUndo(elements);\r\n      setElements((prev) => ({\r\n        ...prev,\r\n        stickyNotes: [\r\n          ...prev.stickyNotes,\r\n          { id: Date.now(), x, y, text: \"Sticky note\" }\r\n        ]\r\n      }));\r\n    } else if (tool === 'text') {\r\n      pushToUndo(elements);\r\n      setElements((prev) => ({\r\n        ...prev,\r\n        textBoxes: [\r\n          ...prev.textBoxes,\r\n          { id: Date.now(), x, y, text: \"Text\" }\r\n        ]\r\n      }));\r\n    } else {\r\n      handlePointerDown(e);\r\n    }\r\n  };\r\n\r\n  // Add handler for adding image from modal\r\n  function handleAddImage({ type, src, position }) {\r\n    pushToUndo(elements);\r\n    setElements((prev) => ({\r\n      ...prev,\r\n      images: [\r\n        ...prev.images,\r\n        { id: Date.now(), x: position.x, y: position.y, src, width: 120, height: 90 }\r\n      ]\r\n    }));\r\n  }\r\n\r\n  // Undo/Redo logic\r\n  const handleUndo = useCallback(() => {\r\n    setUndoStack((prevUndo) => {\r\n      if (prevUndo.length === 0) return prevUndo;\r\n      setRedoStack((prevRedo) => [...prevRedo, elements]);\r\n      const prevElements = prevUndo[prevUndo.length - 1];\r\n      setElements(prevElements);\r\n      return prevUndo.slice(0, -1);\r\n    });\r\n  }, [elements]);\r\n\r\n  const handleRedo = useCallback(() => {\r\n    setRedoStack((prevRedo) => {\r\n      if (prevRedo.length === 0) return prevRedo;\r\n      setUndoStack((prevUndo) => [...prevUndo, elements]);\r\n      const nextElements = prevRedo[prevRedo.length - 1];\r\n      setElements(nextElements);\r\n      return prevRedo.slice(0, -1);\r\n    });\r\n  }, [elements]);\r\n\r\n  // Keyboard shortcuts for undo/redo\r\n  useEffect(() => {\r\n    const handleKeyDown = (e) => {\r\n      if ((e.ctrlKey || e.metaKey) && e.key === \"z\") {\r\n        e.preventDefault();\r\n        handleUndo();\r\n      } else if ((e.ctrlKey || e.metaKey) && (e.key === \"y\" || (e.shiftKey && e.key === \"z\"))) {\r\n        e.preventDefault();\r\n        handleRedo();\r\n      }\r\n    };\r\n    window.addEventListener(\"keydown\", handleKeyDown);\r\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\r\n  }, [handleUndo, handleRedo]);\r\n\r\n  // Draw lines on canvas\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    const ctx = canvas.getContext(\"2d\");\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    ctx.lineCap = \"round\";\r\n    ctx.lineJoin = \"round\";\r\n    elements.lines.forEach((line) => {\r\n      ctx.save();\r\n      ctx.strokeStyle = line.color;\r\n      ctx.globalAlpha = line.opacity !== undefined ? line.opacity : 1;\r\n      ctx.lineWidth = 2.5;\r\n      ctx.beginPath();\r\n      line.points.forEach((pt, i) => {\r\n        if (i === 0) ctx.moveTo(pt.x, pt.y);\r\n        else ctx.lineTo(pt.x, pt.y);\r\n      });\r\n      ctx.stroke();\r\n      ctx.restore();\r\n    });\r\n  }, [elements.lines]);\r\n\r\n  // Replace setTool usage to intercept 'image' tool selection\r\n  function handleToolbarToolSelect(selectedTool) {\r\n    setTool(selectedTool);\r\n    if (selectedTool === 'image') {\r\n      // Center of viewport\r\n      const x = window.innerWidth / 2 - 60;\r\n      const y = window.innerHeight / 2 - 45;\r\n      setPendingImagePos({ x, y });\r\n      setShowAddImageModal(true);\r\n    }\r\n  }\r\n\r\n  // --- SOCKET.IO LOGIC ---\r\n  useEffect(() => {\r\n    const socket = io(SOCKET_SERVER_URL);\r\n    socketRef.current = socket;\r\n    socket.emit('join-board', boardId);\r\n    socket.on('board-state', (data) => {\r\n      setElements(data);\r\n    });\r\n    socket.on('board-update', (data) => {\r\n      setElements(data);\r\n    });\r\n    return () => {\r\n      socket.disconnect();\r\n    };\r\n  }, [boardId]);\r\n\r\n  // Broadcast changes to others\r\n  useEffect(() => {\r\n    if (socketRef.current) {\r\n      socketRef.current.emit('board-update', { boardId, data: elements });\r\n    }\r\n    \r\n  }, [elements]);\r\n\r\n  function applyStyleToSelection(styleType, value) {\r\n    if (editingStickyRef.current && editingStickySelection) {\r\n      editingStickyRef.current.focus();\r\n      document.getSelection().removeAllRanges();\r\n      document.getSelection().addRange(editingStickySelection);\r\n      if (styleType === 'color') {\r\n        document.execCommand('foreColor', false, value);\r\n      } else if (styleType === 'font') {\r\n        document.execCommand('fontName', false, value);\r\n      }\r\n    }\r\n  }\r\n\r\n  function handleTextSelection() {\r\n    const sel = window.getSelection();\r\n    if (sel && sel.rangeCount > 0 && editingTextRef.current && editingTextRef.current.contains(sel.anchorNode)) {\r\n      setEditingTextSelection(sel.getRangeAt(0));\r\n    } else {\r\n      setEditingTextSelection(null);\r\n    }\r\n  }\r\n\r\n  function applyStyleToTextSelection(styleType, value) {\r\n    if (editingTextRef.current && editingTextSelection) {\r\n      editingTextRef.current.focus();\r\n      document.getSelection().removeAllRanges();\r\n      document.getSelection().addRange(editingTextSelection);\r\n      if (styleType === 'color') {\r\n        document.execCommand('foreColor', false, value);\r\n      } else if (styleType === 'font') {\r\n        document.execCommand('fontName', false, value);\r\n      }\r\n    }\r\n  }\r\n\r\n  // Download handlers\r\n  const handleDownload = async (format) => {\r\n    try {\r\n      const canvas = canvasRef.current;\r\n      const ctx = canvas.getContext('2d');\r\n      \r\n      // Create a temporary canvas to combine all elements\r\n      const tempCanvas = document.createElement('canvas');\r\n      tempCanvas.width = canvas.width;\r\n      tempCanvas.height = canvas.height;\r\n      const tempCtx = tempCanvas.getContext('2d');\r\n      \r\n      // Draw background\r\n      tempCtx.fillStyle = isDark ? '#18181b' : '#fafafa';\r\n      tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);\r\n      \r\n      // Draw all elements\r\n      // Draw lines\r\n      elements.lines.forEach((line) => {\r\n        tempCtx.save();\r\n        tempCtx.strokeStyle = line.color;\r\n        tempCtx.globalAlpha = line.opacity !== undefined ? line.opacity : 1;\r\n        tempCtx.lineWidth = 2.5;\r\n        tempCtx.beginPath();\r\n        line.points.forEach((pt, i) => {\r\n          if (i === 0) tempCtx.moveTo(pt.x, pt.y);\r\n          else tempCtx.lineTo(pt.x, pt.y);\r\n        });\r\n        tempCtx.stroke();\r\n        tempCtx.restore();\r\n      });\r\n      \r\n      // Draw sticky notes\r\n      elements.stickyNotes.forEach((note) => {\r\n        tempCtx.save();\r\n        tempCtx.fillStyle = note.color || '#fff';\r\n        tempCtx.fillRect(note.x, note.y, 120, 80);\r\n        tempCtx.fillStyle = '#000';\r\n        tempCtx.font = '14px sans-serif';\r\n        tempCtx.fillText(note.text, note.x + 10, note.y + 20);\r\n        tempCtx.restore();\r\n      });\r\n      \r\n      // Draw text boxes\r\n      elements.textBoxes.forEach((text) => {\r\n        tempCtx.save();\r\n        tempCtx.fillStyle = text.color || '#000';\r\n        tempCtx.font = '14px sans-serif';\r\n        tempCtx.fillText(text.text, text.x, text.y);\r\n        tempCtx.restore();\r\n      });\r\n      \r\n      // Draw images\r\n      const imagePromises = elements.images.map((img) => {\r\n        return new Promise((resolve) => {\r\n          const image = new Image();\r\n          image.crossOrigin = 'anonymous';\r\n          image.onload = () => {\r\n            tempCtx.drawImage(image, img.x, img.y, img.width, img.height);\r\n            resolve();\r\n          };\r\n          image.onerror = () => resolve();\r\n          image.src = img.src;\r\n        });\r\n      });\r\n      \r\n      await Promise.all(imagePromises);\r\n      \r\n      if (format === 'pdf') {\r\n        // Convert to PDF using jsPDF\r\n        const { jsPDF } = await import('jspdf');\r\n        const pdf = new jsPDF({\r\n          orientation: 'landscape',\r\n          unit: 'px',\r\n          format: [tempCanvas.width, tempCanvas.height]\r\n        });\r\n        \r\n        pdf.addImage(\r\n          tempCanvas.toDataURL('image/jpeg', 1.0),\r\n          'JPEG',\r\n          0,\r\n          0,\r\n          tempCanvas.width,\r\n          tempCanvas.height\r\n        );\r\n        \r\n        pdf.save('canvas-export.pdf');\r\n      } else {\r\n        // Download as JPG\r\n        const link = document.createElement('a');\r\n        link.download = 'canvas-export.jpg';\r\n        link.href = tempCanvas.toDataURL('image/jpeg', 0.8);\r\n        link.click();\r\n      }\r\n      \r\n      setShowDownloadModal(false);\r\n    } catch (error) {\r\n      console.error('Error downloading:', error);\r\n      alert('Error downloading the canvas. Please try again.');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div \r\n      className=\"h-screen w-screen relative bg-gray-50 dark:bg-dark\"\r\n      onMouseMove={handleMouseMove}\r\n    >\r\n      <LogoStandalone />\r\n      <TopControlsBox \r\n        onUndo={handleUndo} \r\n        onRedo={handleRedo} \r\n        boardId={boardId} \r\n        onDownload={handleDownload}\r\n      />\r\n      <RightToolbar\r\n        tool={tool}\r\n        eraserSize={eraserSize}\r\n        setEraserSize={setEraserSize}\r\n        color={color}\r\n        setColor={setColor}\r\n        opacity={opacity}\r\n        setOpacity={setOpacity}\r\n        selectedStickyId={selectedStickyId}\r\n        selectedTextId={selectedTextId}\r\n        stickyFont={selectedStickyId ? elements.stickyNotes.find(n => n.id === selectedStickyId)?.font : ''}\r\n        textFont={selectedTextId ? elements.textBoxes.find(t => t.id === selectedTextId)?.font : ''}\r\n        onStickyColorChange={(newColor) => {\r\n          if (!selectedStickyId) return;\r\n          pushToUndo(elements);\r\n          setElements((prev) => ({\r\n            ...prev,\r\n            stickyNotes: prev.stickyNotes.map(n => n.id === selectedStickyId ? { ...n, color: newColor } : n)\r\n          }));\r\n          setColor(newColor);\r\n        }}\r\n        onStickyFontChange={(newFont) => {\r\n          if (!selectedStickyId) return;\r\n          pushToUndo(elements);\r\n          setElements((prev) => ({\r\n            ...prev,\r\n            stickyNotes: prev.stickyNotes.map(n => n.id === selectedStickyId ? { ...n, font: newFont } : n)\r\n          }));\r\n          setStickyFont(newFont);\r\n        }}\r\n        onTextColorChange={(newColor) => {\r\n          if (!selectedTextId) return;\r\n          pushToUndo(elements);\r\n          setElements((prev) => ({\r\n            ...prev,\r\n            textBoxes: prev.textBoxes.map(t => t.id === selectedTextId ? { ...t, color: newColor } : t)\r\n          }));\r\n          setColor(newColor);\r\n        }}\r\n        onTextFontChange={(newFont) => {\r\n          if (!selectedTextId) return;\r\n          pushToUndo(elements);\r\n          setElements((prev) => ({\r\n            ...prev,\r\n            textBoxes: prev.textBoxes.map(t => t.id === selectedTextId ? { ...t, font: newFont } : t)\r\n          }));\r\n        }}\r\n        elements={elements}\r\n      />\r\n      <canvas\r\n        ref={canvasRef}\r\n        width={window.innerWidth}\r\n        height={window.innerHeight}\r\n        className=\"block absolute top-0 left-0 w-full h-full\"\r\n        style={{\r\n          cursor: tool === 'draw' ? 'crosshair' : tool === 'eraser' ? 'none' : 'default',\r\n          background: 'transparent',\r\n        }}\r\n        onPointerDown={handleCanvasPointerDown}\r\n        onPointerMove={handlePointerMove}\r\n        onPointerUp={handlePointerUp}\r\n        onPointerLeave={handlePointerUp}\r\n      />\r\n      {/* Sticky Notes */}\r\n      {elements.stickyNotes.map((note) => (\r\n        <StickyNote\r\n          key={note.id}\r\n          id={note.id}\r\n          x={note.x}\r\n          y={note.y}\r\n          width={120}\r\n          height={80}\r\n          rotation={0}\r\n          color={note.color || \"#fff\"}\r\n          font={note.font || \"Inter, sans-serif\"}\r\n          text={note.text}\r\n          isEditing={editingStickyId === note.id}\r\n          isSelected={selectedStickyId === note.id}\r\n          onClick={() => setSelectedStickyId(note.id)}\r\n          onChange={(newText) => {\r\n            pushToUndo(elements);\r\n            setElements((prev) => ({\r\n              ...prev,\r\n              stickyNotes: prev.stickyNotes.map(n => n.id === note.id ? { ...n, text: newText } : n)\r\n            }));\r\n          }}\r\n          onEdit={() => setEditingStickyId(note.id)}\r\n          onDelete={() => {\r\n            pushToUndo(elements);\r\n            setElements((prev) => ({\r\n              ...prev,\r\n              stickyNotes: prev.stickyNotes.filter(n => n.id !== note.id)\r\n            }));\r\n            if (selectedStickyId === note.id) setSelectedStickyId(null);\r\n          }}\r\n          onDrag={(pos) => {\r\n            pushToUndo(elements);\r\n            setElements((prev) => ({\r\n              ...prev,\r\n              stickyNotes: prev.stickyNotes.map(n => n.id === note.id ? { ...n, ...pos } : n)\r\n            }));\r\n          }}\r\n          onResize={(size) => {\r\n            pushToUndo(elements);\r\n            setElements((prev) => ({\r\n              ...prev,\r\n              stickyNotes: prev.stickyNotes.map(n => n.id === note.id ? { ...n, ...size } : n)\r\n            }));\r\n          }}\r\n          onRotate={(rotation) => {\r\n            pushToUndo(elements);\r\n            setElements((prev) => ({\r\n              ...prev,\r\n              stickyNotes: prev.stickyNotes.map(n => n.id === note.id ? { ...n, rotation } : n)\r\n            }));\r\n          }}\r\n          editingRef={editingStickyId === note.id ? editingStickyRef : undefined}\r\n          onSelectionChange={editingStickyId === note.id ? setEditingStickySelection : undefined}\r\n        />\r\n      ))}\r\n      {/* Images */}\r\n      {elements.images.map((img) => (\r\n        <Draggable\r\n          key={img.id}\r\n          x={img.x}\r\n          y={img.y}\r\n          onDrag={(pos) => {\r\n            pushToUndo(elements);\r\n            setElements((prev) => ({\r\n              ...prev,\r\n              images: prev.images.map(i => i.id === img.id ? { ...i, ...pos } : i)\r\n            }));\r\n          }}\r\n        >\r\n          <img src={img.src} alt=\"uploaded\" style={{ width: img.width, height: img.height, borderRadius: 8, boxShadow: '0 2px 8px rgba(0,0,0,0.12)' }} />\r\n        </Draggable>\r\n      ))}\r\n      {/* Text Boxes */}\r\n      {elements.textBoxes.map((tb) => (\r\n        <Draggable\r\n          key={tb.id}\r\n          x={tb.x}\r\n          y={tb.y}\r\n          onDrag={(pos) => {\r\n            pushToUndo(elements);\r\n            setElements((prev) => ({\r\n              ...prev,\r\n              textBoxes: prev.textBoxes.map(t => t.id === tb.id ? { ...t, ...pos } : t)\r\n            }));\r\n          }}\r\n        >\r\n          <div\r\n            className={`rounded bg-white/80 dark:bg-zinc-900/80 px-2 py-1 text-base shadow border border-gray-200 dark:border-zinc-700 cursor-pointer ${selectedTextId === tb.id ? 'ring-2 ring-blue-500 ring-offset-2' : ''}`}\r\n            style={{\r\n              fontFamily: tb.font || 'inherit',\r\n              fontWeight: 500,\r\n              minWidth: 60,\r\n              color: tb.color || '#222',\r\n              transition: 'box-shadow 0.2s, transform 0.2s',\r\n            }}\r\n            onClick={() => setSelectedTextId(tb.id)}\r\n          >\r\n            {editingTextId === tb.id ? (\r\n              <div\r\n                ref={editingTextId === tb.id ? editingTextRef : undefined}\r\n                contentEditable\r\n                suppressContentEditableWarning\r\n                className=\"bg-transparent outline-none w-full\"\r\n                style={{ fontFamily: tb.font || 'inherit', color: tb.color || '#222' }}\r\n                onBlur={() => setEditingTextId(null)}\r\n                onInput={e => setElements((prev) => ({\r\n                  ...prev,\r\n                  textBoxes: prev.textBoxes.map(t => t.id === tb.id ? { ...t, text: e.currentTarget.innerHTML } : t)\r\n                }))}\r\n                onSelect={handleTextSelection}\r\n                onKeyUp={handleTextSelection}\r\n                onMouseUp={handleTextSelection}\r\n                dangerouslySetInnerHTML={{ __html: tb.text }}\r\n              />\r\n            ) : (\r\n              tb.text\r\n            )}\r\n          </div>\r\n        </Draggable>\r\n      ))}\r\n      {/* Eraser cursor and preview */}\r\n      {tool === 'eraser' && (\r\n        <div\r\n          style={{\r\n            position: 'fixed',\r\n            left: mousePos.x + canvasRef.current?.getBoundingClientRect().left - eraserSize / 2,\r\n            top: mousePos.y + canvasRef.current?.getBoundingClientRect().top - eraserSize / 2,\r\n            width: eraserSize,\r\n            height: eraserSize,\r\n            pointerEvents: 'none',\r\n            borderRadius: '50%',\r\n            border: '2px solid #f87171',\r\n            background: isDark ? 'rgba(255,255,255,0.08)' : 'rgba(0,0,0,0.08)',\r\n            boxShadow: '0 0 8px 2px rgba(248,113,113,0.2)',\r\n            zIndex: 1000,\r\n            transition: 'transform 0.05s ease-out',\r\n            transform: 'translate3d(0, 0, 0)',\r\n            willChange: 'transform',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n          }}\r\n        >\r\n          {/* Small crosshair in the center */}\r\n          <div\r\n            style={{\r\n              width: '2px',\r\n              height: '2px',\r\n              background: '#f87171',\r\n              borderRadius: '50%',\r\n              boxShadow: '0 0 2px 1px rgba(248,113,113,0.5)',\r\n            }}\r\n          />\r\n        </div>\r\n      )}\r\n      <BottomToolbar tool={tool} setTool={handleToolbarToolSelect} />\r\n      <AddImageModal open={showAddImageModal} onClose={() => setShowAddImageModal(false)} onAdd={handleAddImage} position={pendingImagePos} isDark={isDark} />\r\n    </div>\r\n  );\r\n}\r\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}